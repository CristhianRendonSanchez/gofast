{"generator":"Code Snippets v3.9.3","date_created":"2025-12-12 19:47","snippets":[{"id":27,"name":"gofast_reportes_admin","code":"\/***************************************************\n * GOFAST \u2013 REPORTES DE PEDIDOS (ADMIN Y MENSAJERO)\n * Shortcode: [gofast_reportes_admin]\n * URL: \/admin-reportes\n ***************************************************\/\nfunction gofast_reportes_admin_shortcode() {\n    if (session_status() === PHP_SESSION_NONE) {\n        session_start();\n    }\n\n    global $wpdb;\n\n    $tabla = 'servicios_gofast';\n\n    \/* ==========================================================\n       0. Validar usuario (admin o mensajero)\n    ========================================================== *\/\n    $usuario = null;\n    if (!empty($_SESSION['gofast_user_id'])) {\n        $uid = (int) $_SESSION['gofast_user_id'];\n        $usuario = $wpdb->get_row(\n            $wpdb->prepare(\n                \"SELECT id, nombre, rol, activo \n                 FROM usuarios_gofast \n                 WHERE id = %d AND activo = 1\",\n                $uid\n            )\n        );\n    }\n\n    if (!$usuario || !in_array(strtolower($usuario->rol), ['admin', 'mensajero'])) {\n        return \"<div class='gofast-box'>\n                    \u26a0\ufe0f Solo los administradores y mensajeros pueden ver reportes.\n                <\/div>\";\n    }\n\n    $rol = strtolower($usuario->rol);\n    $es_admin = ($rol === 'admin');\n\n    \/* ==========================================================\n       1. Filtros (GET)\n    ========================================================== *\/\n    $estado = isset($_GET['estado']) ? sanitize_text_field($_GET['estado']) : '';\n    $desde = isset($_GET['desde']) ? sanitize_text_field($_GET['desde']) : '';\n    $hasta = isset($_GET['hasta']) ? sanitize_text_field($_GET['hasta']) : '';\n    $mensajero_id = isset($_GET['mensajero_id']) ? (int) $_GET['mensajero_id'] : 0;\n    $buscar = isset($_GET['q']) ? sanitize_text_field($_GET['q']) : '';\n    $tipo_servicio = isset($_GET['tipo_servicio']) ? sanitize_text_field($_GET['tipo_servicio']) : 'todos';\n    \n    \/\/ Paginaci\u00f3n para tablas\n    $por_pagina = 15;\n    $pg_pedidos = isset($_GET['pg_pedidos']) ? max(1, (int) $_GET['pg_pedidos']) : 1;\n    $pg_mensajeros = isset($_GET['pg_mensajeros']) ? max(1, (int) $_GET['pg_mensajeros']) : 1;\n    $pg_dias = isset($_GET['pg_dias']) ? max(1, (int) $_GET['pg_dias']) : 1;\n\n    if ($desde && !preg_match('\/^\\d{4}-\\d{2}-\\d{2}$\/', $desde)) $desde = '';\n    if ($hasta && !preg_match('\/^\\d{4}-\\d{2}-\\d{2}$\/', $hasta)) $hasta = '';\n\n    \/\/ Si no hay fechas, usar d\u00eda actual por defecto (fecha Colombia)\n    if (!$desde && !$hasta) {\n        $desde = gofast_current_time('Y-m-d');\n        $hasta = gofast_current_time('Y-m-d');\n    }\n\n    $where = \"1=1\";\n    $params = [];\n\n    \/\/ Si es mensajero, filtrar autom\u00e1ticamente por su ID\n    if (!$es_admin) {\n        $where .= \" AND mensajero_id = %d\";\n        $params[] = $usuario->id;\n    } elseif ($mensajero_id > 0) {\n        \/\/ Solo admin puede filtrar por mensajero\n        $where .= \" AND mensajero_id = %d\";\n        $params[] = $mensajero_id;\n    }\n\n    if ($estado !== '' && $estado !== 'todos') {\n        $where .= \" AND tracking_estado = %s\";\n        $params[] = $estado;\n    }\n\n    if ($desde !== '') {\n        $where .= \" AND fecha >= %s\";\n        $params[] = $desde . ' 00:00:00';\n    }\n    if ($hasta !== '') {\n        $where .= \" AND fecha <= %s\";\n        $params[] = $hasta . ' 23:59:59';\n    }\n\n    if ($buscar !== '') {\n        $like = '%' . $wpdb->esc_like($buscar) . '%';\n        $where .= \" AND (nombre_cliente LIKE %s OR telefono_cliente LIKE %s)\";\n        $params[] = $like;\n        $params[] = $like;\n    }\n\n    \/\/ Filtro por tipo de servicio (normal o intermunicipal)\n    if ($tipo_servicio === 'intermunicipal') {\n        \/\/ Filtrar env\u00edos intermunicipales: tienen \"tipo_servicio\": \"intermunicipal\" en JSON o \"(Intermunicipal)\" en direccion_origen\n        $where .= \" AND (JSON_EXTRACT(destinos, '$.tipo_servicio') = %s OR direccion_origen LIKE %s)\";\n        $params[] = '\"intermunicipal\"';\n        $params[] = '%(Intermunicipal)%';\n    } elseif ($tipo_servicio === 'normal') {\n        \/\/ Filtrar servicios normales: NO tienen tipo_servicio intermunicipal y NO tienen \"(Intermunicipal)\" en direccion_origen\n        $where .= \" AND (JSON_EXTRACT(destinos, '$.tipo_servicio') IS NULL OR JSON_EXTRACT(destinos, '$.tipo_servicio') != %s) AND direccion_origen NOT LIKE %s\";\n        $params[] = '\"intermunicipal\"';\n        $params[] = '%(Intermunicipal)%';\n    }\n    \/\/ Si es 'todos', no se aplica filtro\n\n    \/* ==========================================================\n       2. Estad\u00edsticas de Servicios\n    ========================================================== *\/\n    \/\/ Construir WHERE para servicios (excluyendo cancelados para ingresos)\n    $where_servicios = $where;\n    $where_servicios_ingresos = $where . \" AND tracking_estado != 'cancelado'\";\n    \n    \/\/ Contar total de destinos (usando JSON_LENGTH)\n    if (!empty($params)) {\n        $sql_total_destinos = $wpdb->prepare(\n            \"SELECT \n                SUM(JSON_LENGTH(JSON_EXTRACT(destinos, '$.destinos'))) as total_destinos\n             FROM $tabla \n             WHERE $where_servicios\",\n            $params\n        );\n    } else {\n        $sql_total_destinos = \"SELECT \n                SUM(JSON_LENGTH(JSON_EXTRACT(destinos, '$.destinos'))) as total_destinos\n             FROM $tabla \n             WHERE $where_servicios\";\n    }\n    \n    $total_destinos = (int) ($wpdb->get_var($sql_total_destinos) ?? 0);\n    \n    \/\/ Ingresos de servicios (excluyendo cancelados)\n    $params_ingresos = $params;\n    if (!empty($params)) {\n        $sql_ingresos_servicios = $wpdb->prepare(\n            \"SELECT \n                SUM(total) as total_ingresos_servicios\n             FROM $tabla \n             WHERE $where_servicios_ingresos\",\n            $params_ingresos\n        );\n    } else {\n        $sql_ingresos_servicios = \"SELECT \n                SUM(total) as total_ingresos_servicios\n             FROM $tabla \n             WHERE $where_servicios_ingresos\";\n    }\n    \n    $ingresos_servicios = (float) ($wpdb->get_var($sql_ingresos_servicios) ?? 0);\n    \n    \/\/ Contar pedidos sin asignar (sin mensajero)\n    \/\/ Construir WHERE sin el filtro de mensajero, pero con los dem\u00e1s filtros\n    $where_sin_asignar = \"1=1\";\n    $params_sin_asignar = [];\n    \n    \/\/ NO incluir filtro de mensajero para pedidos sin asignar\n    \/\/ Solo aplicar filtros de estado, fecha y b\u00fasqueda\n    \n    if ($estado !== '' && $estado !== 'todos') {\n        $where_sin_asignar .= \" AND tracking_estado = %s\";\n        $params_sin_asignar[] = $estado;\n    }\n    \n    if ($desde !== '') {\n        $where_sin_asignar .= \" AND fecha >= %s\";\n        $params_sin_asignar[] = $desde . ' 00:00:00';\n    }\n    if ($hasta !== '') {\n        $where_sin_asignar .= \" AND fecha <= %s\";\n        $params_sin_asignar[] = $hasta . ' 23:59:59';\n    }\n    \n    if ($buscar !== '') {\n        $like = '%' . $wpdb->esc_like($buscar) . '%';\n        $where_sin_asignar .= \" AND (nombre_cliente LIKE %s OR telefono_cliente LIKE %s)\";\n        $params_sin_asignar[] = $like;\n        $params_sin_asignar[] = $like;\n    }\n\n    \/\/ Aplicar filtro de tipo de servicio tambi\u00e9n a pedidos sin asignar\n    if ($tipo_servicio === 'intermunicipal') {\n        $where_sin_asignar .= \" AND (JSON_EXTRACT(destinos, '$.tipo_servicio') = %s OR direccion_origen LIKE %s)\";\n        $params_sin_asignar[] = '\"intermunicipal\"';\n        $params_sin_asignar[] = '%(Intermunicipal)%';\n    } elseif ($tipo_servicio === 'normal') {\n        $where_sin_asignar .= \" AND (JSON_EXTRACT(destinos, '$.tipo_servicio') IS NULL OR JSON_EXTRACT(destinos, '$.tipo_servicio') != %s) AND direccion_origen NOT LIKE %s\";\n        $params_sin_asignar[] = '\"intermunicipal\"';\n        $params_sin_asignar[] = '%(Intermunicipal)%';\n    }\n    \n    \/\/ Condici\u00f3n principal: sin mensajero asignado\n    $where_sin_asignar .= \" AND mensajero_id IS NULL\";\n    \n    if (!empty($params_sin_asignar)) {\n        $sql_sin_asignar = $wpdb->prepare(\n            \"SELECT COUNT(*) as pedidos_sin_asignar\n             FROM $tabla \n             WHERE $where_sin_asignar\",\n            $params_sin_asignar\n        );\n    } else {\n        $sql_sin_asignar = \"SELECT COUNT(*) as pedidos_sin_asignar\n             FROM $tabla \n             WHERE $where_sin_asignar\";\n    }\n    \n    $pedidos_sin_asignar = (int) ($wpdb->get_var($sql_sin_asignar) ?? 0);\n    \n    \/* ==========================================================\n       3. Estad\u00edsticas de Compras\n    ========================================================== *\/\n    $tabla_compras = 'compras_gofast';\n    $where_compras = \"1=1\";\n    $params_compras = [];\n    \n    \/\/ Aplicar filtros de mensajero\n    if (!$es_admin) {\n        $where_compras .= \" AND mensajero_id = %d\";\n        $params_compras[] = $usuario->id;\n    } elseif ($mensajero_id > 0) {\n        $where_compras .= \" AND mensajero_id = %d\";\n        $params_compras[] = $mensajero_id;\n    }\n    \n    \/\/ Aplicar filtros de fecha\n    if ($desde !== '') {\n        $where_compras .= \" AND fecha_creacion >= %s\";\n        $params_compras[] = $desde . ' 00:00:00';\n    }\n    if ($hasta !== '') {\n        $where_compras .= \" AND fecha_creacion <= %s\";\n        $params_compras[] = $hasta . ' 23:59:59';\n    }\n    \n    \/\/ Excluir canceladas\n    $where_compras .= \" AND estado != 'cancelada'\";\n    \n    \/\/ Contar total de compras\n    if (!empty($params_compras)) {\n        $sql_total_compras = $wpdb->prepare(\n            \"SELECT COUNT(*) as total_compras\n             FROM $tabla_compras \n             WHERE $where_compras\",\n            $params_compras\n        );\n    } else {\n        $sql_total_compras = \"SELECT COUNT(*) as total_compras\n             FROM $tabla_compras \n             WHERE $where_compras\";\n    }\n    \n    $total_compras = (int) ($wpdb->get_var($sql_total_compras) ?? 0);\n    \n    \/\/ Ingresos de compras (excluyendo canceladas)\n    if (!empty($params_compras)) {\n        $sql_ingresos_compras = $wpdb->prepare(\n            \"SELECT SUM(valor) as total_ingresos_compras\n             FROM $tabla_compras \n             WHERE $where_compras\",\n            $params_compras\n        );\n    } else {\n        $sql_ingresos_compras = \"SELECT SUM(valor) as total_ingresos_compras\n             FROM $tabla_compras \n             WHERE $where_compras\";\n    }\n    \n    $ingresos_compras = (float) ($wpdb->get_var($sql_ingresos_compras) ?? 0);\n    \n    \/\/ Ingresos totales (servicios + compras, excluyendo cancelados)\n    $total_ingresos = $ingresos_servicios + $ingresos_compras;\n    \n    \/* ==========================================================\n       4. C\u00e1lculos de Comisi\u00f3n y Utilidad\n    ========================================================== *\/\n    \/\/ Comisi\u00f3n generada: 20% de los ingresos totales\n    $comision_generada = $total_ingresos * 0.20;\n    \n    \/\/ Utilidad neta: ingresos totales - comisi\u00f3n\n    $utilidad_neta = $total_ingresos - $comision_generada;\n    \n    \/* ==========================================================\n       5. Estad\u00edsticas de Transferencias\n    ========================================================== *\/\n    $tabla_transferencias = 'transferencias_gofast';\n    $where_transferencias = \"1=1\";\n    $params_transferencias = [];\n    \n    \/\/ Aplicar filtros de mensajero\n    if (!$es_admin) {\n        $where_transferencias .= \" AND mensajero_id = %d\";\n        $params_transferencias[] = $usuario->id;\n    } elseif ($mensajero_id > 0) {\n        $where_transferencias .= \" AND mensajero_id = %d\";\n        $params_transferencias[] = $mensajero_id;\n    }\n    \n    \/\/ Aplicar filtros de fecha\n    if ($desde !== '') {\n        $where_transferencias .= \" AND fecha_creacion >= %s\";\n        $params_transferencias[] = $desde . ' 00:00:00';\n    }\n    if ($hasta !== '') {\n        $where_transferencias .= \" AND fecha_creacion <= %s\";\n        $params_transferencias[] = $hasta . ' 23:59:59';\n    }\n    \n    \/\/ Solo transferencias aprobadas\n    $where_transferencias .= \" AND estado = 'aprobada'\";\n    \n    \/\/ Sumar valor de transferencias aprobadas\n    if (!empty($params_transferencias)) {\n        $sql_transferencias_aprobadas = $wpdb->prepare(\n            \"SELECT SUM(valor) as total_transferencias_aprobadas\n             FROM $tabla_transferencias \n             WHERE $where_transferencias\",\n            $params_transferencias\n        );\n    } else {\n        $sql_transferencias_aprobadas = \"SELECT SUM(valor) as total_transferencias_aprobadas\n             FROM $tabla_transferencias \n             WHERE $where_transferencias\";\n    }\n    \n    $transferencias_aprobadas = (float) ($wpdb->get_var($sql_transferencias_aprobadas) ?? 0);\n    \n    \/\/ Total a pagar: comisi\u00f3n - transferencias aprobadas\n    $total_a_pagar = $comision_generada - $transferencias_aprobadas;\n\n    \/* ==========================================================\n       6. Pedidos del D\u00eda Actual\n    ========================================================== *\/\n    $fecha_hoy = gofast_current_time('Y-m-d');\n    $where_pedidos_hoy = \"1=1\";\n    $params_pedidos_hoy = [];\n    \n    \/\/ Aplicar filtros de mensajero\n    if (!$es_admin) {\n        $where_pedidos_hoy .= \" AND mensajero_id = %d\";\n        $params_pedidos_hoy[] = $usuario->id;\n    } elseif ($mensajero_id > 0) {\n        $where_pedidos_hoy .= \" AND mensajero_id = %d\";\n        $params_pedidos_hoy[] = $mensajero_id;\n    }\n    \n    \/\/ Solo pedidos del d\u00eda actual\n    $where_pedidos_hoy .= \" AND DATE(fecha) = %s\";\n    $params_pedidos_hoy[] = $fecha_hoy;\n    \n    \/\/ Contar total de pedidos del d\u00eda\n    if (!empty($params_pedidos_hoy)) {\n        $sql_count_hoy = $wpdb->prepare(\n            \"SELECT COUNT(*) as total\n             FROM $tabla\n             WHERE $where_pedidos_hoy\",\n            $params_pedidos_hoy\n        );\n    } else {\n        $sql_count_hoy = \"SELECT COUNT(*) as total\n             FROM $tabla\n             WHERE $where_pedidos_hoy\";\n    }\n    \n    $total_pedidos_hoy = (int) ($wpdb->get_var($sql_count_hoy) ?? 0);\n    $total_paginas_pedidos = max(1, (int) ceil($total_pedidos_hoy \/ $por_pagina));\n    $offset_pedidos = ($pg_pedidos - 1) * $por_pagina;\n    \n    \/\/ Obtener pedidos del d\u00eda actual (con paginaci\u00f3n)\n    $params_pedidos_hoy_limit = $params_pedidos_hoy;\n    $params_pedidos_hoy_limit[] = $por_pagina;\n    $params_pedidos_hoy_limit[] = $offset_pedidos;\n    \n    if (!empty($params_pedidos_hoy)) {\n        $sql_pedidos_hoy = $wpdb->prepare(\n            \"SELECT \n                id,\n                fecha,\n                direccion_origen,\n                destinos,\n                total,\n                mensajero_id\n             FROM $tabla\n             WHERE $where_pedidos_hoy\n             ORDER BY fecha DESC\n             LIMIT %d OFFSET %d\",\n            $params_pedidos_hoy_limit\n        );\n    } else {\n        $sql_pedidos_hoy = $wpdb->prepare(\n            \"SELECT \n                id,\n                fecha,\n                direccion_origen,\n                destinos,\n                total,\n                mensajero_id\n             FROM $tabla\n             WHERE $where_pedidos_hoy\n             ORDER BY fecha DESC\n             LIMIT %d OFFSET %d\",\n            $por_pagina,\n            $offset_pedidos\n        );\n    }\n    \n    $pedidos_hoy = $wpdb->get_results($sql_pedidos_hoy);\n\n    \/* ==========================================================\n       6.1. Compras del D\u00eda Actual\n    ========================================================== *\/\n    $where_compras_hoy = \"1=1\";\n    $params_compras_hoy = [];\n    \n    \/\/ Aplicar filtros de mensajero\n    if (!$es_admin) {\n        $where_compras_hoy .= \" AND mensajero_id = %d\";\n        $params_compras_hoy[] = $usuario->id;\n    } elseif ($mensajero_id > 0) {\n        $where_compras_hoy .= \" AND mensajero_id = %d\";\n        $params_compras_hoy[] = $mensajero_id;\n    }\n    \n    \/\/ Solo compras del d\u00eda actual\n    $where_compras_hoy .= \" AND DATE(fecha_creacion) = %s\";\n    $params_compras_hoy[] = $fecha_hoy;\n    \n    \/\/ Excluir canceladas\n    $where_compras_hoy .= \" AND estado != 'cancelada'\";\n    \n    \/\/ Contar total de compras del d\u00eda\n    if (!empty($params_compras_hoy)) {\n        $sql_count_compras_hoy = $wpdb->prepare(\n            \"SELECT COUNT(*) as total\n             FROM $tabla_compras\n             WHERE $where_compras_hoy\",\n            $params_compras_hoy\n        );\n    } else {\n        $sql_count_compras_hoy = \"SELECT COUNT(*) as total\n             FROM $tabla_compras\n             WHERE $where_compras_hoy\";\n    }\n    \n    $total_compras_hoy = (int) ($wpdb->get_var($sql_count_compras_hoy) ?? 0);\n    $pg_compras_hoy = isset($_GET['pg_compras_hoy']) ? max(1, (int) $_GET['pg_compras_hoy']) : 1;\n    $total_paginas_compras_hoy = max(1, (int) ceil($total_compras_hoy \/ $por_pagina));\n    $offset_compras_hoy = ($pg_compras_hoy - 1) * $por_pagina;\n    \n    \/\/ Obtener compras del d\u00eda actual (con paginaci\u00f3n)\n    $params_compras_hoy_limit = $params_compras_hoy;\n    $params_compras_hoy_limit[] = $por_pagina;\n    $params_compras_hoy_limit[] = $offset_compras_hoy;\n    \n    if (!empty($params_compras_hoy)) {\n        $sql_compras_hoy = $wpdb->prepare(\n            \"SELECT c.*, \n                    m.nombre as mensajero_nombre,\n                    m.telefono as mensajero_telefono,\n                    u.nombre as creador_nombre,\n                    b.nombre as barrio_nombre\n             FROM $tabla_compras c\n             LEFT JOIN usuarios_gofast m ON c.mensajero_id = m.id\n             LEFT JOIN usuarios_gofast u ON c.creado_por = u.id\n             LEFT JOIN barrios b ON c.barrio_id = b.id\n             WHERE $where_compras_hoy\n             ORDER BY c.fecha_creacion DESC\n             LIMIT %d OFFSET %d\",\n            $params_compras_hoy_limit\n        );\n    } else {\n        $sql_compras_hoy = $wpdb->prepare(\n            \"SELECT c.*, \n                    m.nombre as mensajero_nombre,\n                    m.telefono as mensajero_telefono,\n                    u.nombre as creador_nombre,\n                    b.nombre as barrio_nombre\n             FROM $tabla_compras c\n             LEFT JOIN usuarios_gofast m ON c.mensajero_id = m.id\n             LEFT JOIN usuarios_gofast u ON c.creado_por = u.id\n             LEFT JOIN barrios b ON c.barrio_id = b.id\n             WHERE $where_compras_hoy\n             ORDER BY c.fecha_creacion DESC\n             LIMIT %d OFFSET %d\",\n            $por_pagina,\n            $offset_compras_hoy\n        );\n    }\n    \n    $compras_hoy = $wpdb->get_results($sql_compras_hoy);\n\n    \/\/ Top mensajeros (solo para admin) - con paginaci\u00f3n\n    $top_mensajeros = [];\n    $total_mensajeros = 0;\n    $total_paginas_mensajeros = 0;\n    if ($es_admin) {\n        \/\/ Contar total de mensajeros\n        if (!empty($params)) {\n            $sql_count_mensajeros = $wpdb->prepare(\n                \"SELECT COUNT(DISTINCT u.id)\n                 FROM $tabla s\n                 INNER JOIN usuarios_gofast u ON s.mensajero_id = u.id\n                 WHERE $where AND s.tracking_estado = 'entregado'\",\n                $params\n            );\n        } else {\n            $sql_count_mensajeros = \"SELECT COUNT(DISTINCT u.id)\n                 FROM $tabla s\n                 INNER JOIN usuarios_gofast u ON s.mensajero_id = u.id\n                 WHERE $where AND s.tracking_estado = 'entregado'\";\n        }\n        $total_mensajeros = (int) ($wpdb->get_var($sql_count_mensajeros) ?? 0);\n        $total_paginas_mensajeros = max(1, (int) ceil($total_mensajeros \/ $por_pagina));\n        $offset_mensajeros = ($pg_mensajeros - 1) * $por_pagina;\n        \n        $params_mensajeros = $params;\n        $params_mensajeros[] = $por_pagina;\n        $params_mensajeros[] = $offset_mensajeros;\n        \n        $top_mensajeros = $wpdb->get_results(\n            $wpdb->prepare(\n                \"SELECT \n                    u.id,\n                    u.nombre,\n                    COUNT(s.id) as total_entregados,\n                    SUM(s.total) as total_ingresos\n                 FROM $tabla s\n                 INNER JOIN usuarios_gofast u ON s.mensajero_id = u.id\n                 WHERE $where AND s.tracking_estado = 'entregado'\n                 GROUP BY u.id, u.nombre\n                 ORDER BY total_entregados DESC\n                 LIMIT %d OFFSET %d\",\n                $params_mensajeros\n            )\n        );\n    }\n\n    \/\/ Pedidos por d\u00eda (\u00faltimos 30 d\u00edas) - respeta filtros aplicados (zona horaria Colombia)\n    $timezone = new DateTimeZone('America\/Bogota');\n    $datetime = new DateTime('now', $timezone);\n    $datetime->modify('-30 days');\n    $fecha_desde_30dias = $datetime->format('Y-m-d');\n    $fecha_hasta_hoy = gofast_current_time('Y-m-d');\n    \n    \/\/ Construir WHERE para pedidos por d\u00eda respetando filtros\n    $where_pedidos_dia = \"1=1\";\n    $params_pedidos_dia = [];\n    \n    if (!$es_admin) {\n        $where_pedidos_dia .= \" AND mensajero_id = %d\";\n        $params_pedidos_dia[] = $usuario->id;\n    } elseif ($mensajero_id > 0) {\n        $where_pedidos_dia .= \" AND mensajero_id = %d\";\n        $params_pedidos_dia[] = $mensajero_id;\n    }\n    \n    $where_pedidos_dia .= \" AND fecha >= %s AND fecha <= %s\";\n    $params_pedidos_dia[] = $fecha_desde_30dias . ' 00:00:00';\n    $params_pedidos_dia[] = $fecha_hasta_hoy . ' 23:59:59';\n    \n    \/\/ Construir WHERE para compras por d\u00eda\n    $where_compras_dia = \"1=1\";\n    $params_compras_dia = [];\n    \n    if (!$es_admin) {\n        $where_compras_dia .= \" AND mensajero_id = %d\";\n        $params_compras_dia[] = $usuario->id;\n    } elseif ($mensajero_id > 0) {\n        $where_compras_dia .= \" AND mensajero_id = %d\";\n        $params_compras_dia[] = $mensajero_id;\n    }\n    \n    $where_compras_dia .= \" AND fecha_creacion >= %s AND fecha_creacion <= %s AND estado != 'cancelada'\";\n    $params_compras_dia[] = $fecha_desde_30dias . ' 00:00:00';\n    $params_compras_dia[] = $fecha_hasta_hoy . ' 23:59:59';\n    \n    \/\/ Contar total de d\u00edas \u00fanicos para paginaci\u00f3n\n    if (!empty($params_pedidos_dia)) {\n        $sql_count_dias = $wpdb->prepare(\n            \"SELECT COUNT(DISTINCT DATE(fecha))\n             FROM $tabla\n             WHERE $where_pedidos_dia AND tracking_estado != 'cancelado'\",\n            $params_pedidos_dia\n        );\n    } else {\n        $sql_count_dias = \"SELECT COUNT(DISTINCT DATE(fecha))\n             FROM $tabla\n             WHERE $where_pedidos_dia AND tracking_estado != 'cancelado'\";\n    }\n    $total_dias = (int) ($wpdb->get_var($sql_count_dias) ?? 0);\n    $total_paginas_dias = max(1, (int) ceil($total_dias \/ $por_pagina));\n    $offset_dias = ($pg_dias - 1) * $por_pagina;\n    \n    if (!empty($params_pedidos_dia)) {\n        \/\/ Consulta de servicios con destinos y ingresos (con paginaci\u00f3n)\n        $params_pedidos_dia_limit = $params_pedidos_dia;\n        $params_pedidos_dia_limit[] = $por_pagina;\n        $params_pedidos_dia_limit[] = $offset_dias;\n        \n        $pedidos_por_dia = $wpdb->get_results(\n            $wpdb->prepare(\n                \"SELECT \n                    DATE(fecha) as dia,\n                    SUM(JSON_LENGTH(JSON_EXTRACT(destinos, '$.destinos'))) as cantidad_destinos,\n                    SUM(CASE WHEN tracking_estado != 'cancelado' THEN total ELSE 0 END) as ingresos\n                 FROM $tabla\n                 WHERE $where_pedidos_dia AND tracking_estado != 'cancelado'\n                 GROUP BY DATE(fecha)\n                 ORDER BY dia DESC\n                 LIMIT %d OFFSET %d\",\n                $params_pedidos_dia_limit\n            )\n        );\n        \n        \/\/ Consulta de compras por d\u00eda (cantidad e ingresos)\n        if (!empty($params_compras_dia)) {\n            $compras_por_dia = $wpdb->get_results(\n                $wpdb->prepare(\n                    \"SELECT \n                        DATE(fecha_creacion) as dia,\n                        COUNT(*) as cantidad_compras,\n                        SUM(valor) as ingresos_compras\n                     FROM $tabla_compras\n                     WHERE $where_compras_dia\n                     GROUP BY DATE(fecha_creacion)\n                     ORDER BY dia DESC\n                     LIMIT 30\",\n                    $params_compras_dia\n                )\n            );\n        } else {\n            $compras_por_dia = [];\n        }\n        \n        \/\/ Combinar datos de servicios y compras por d\u00eda\n        $pedidos_por_dia_completo = [];\n        \n        \/\/ Agregar servicios\n        foreach ($pedidos_por_dia as $servicio) {\n            $dia_key = $servicio->dia;\n            $pedidos_por_dia_completo[$dia_key] = [\n                'dia' => $dia_key,\n                'cantidad_destinos' => (int) ($servicio->cantidad_destinos ?? 0),\n                'cantidad_compras' => 0,\n                'ingresos' => (float) ($servicio->ingresos ?? 0),\n                'comision' => 0\n            ];\n        }\n        \n        \/\/ Agregar compras y sumar ingresos\n        foreach ($compras_por_dia as $compra) {\n            $dia_key = $compra->dia;\n            if (!isset($pedidos_por_dia_completo[$dia_key])) {\n                $pedidos_por_dia_completo[$dia_key] = [\n                    'dia' => $dia_key,\n                    'cantidad_destinos' => 0,\n                    'cantidad_compras' => 0,\n                    'ingresos' => 0,\n                    'comision' => 0\n                ];\n            }\n            $pedidos_por_dia_completo[$dia_key]['cantidad_compras'] = (int) $compra->cantidad_compras;\n            $pedidos_por_dia_completo[$dia_key]['ingresos'] += (float) ($compra->ingresos_compras ?? 0);\n        }\n        \n        \/\/ Calcular comisi\u00f3n (20% de ingresos totales)\n        foreach ($pedidos_por_dia_completo as $key => $dia_data) {\n            $pedidos_por_dia_completo[$key]['comision'] = $dia_data['ingresos'] * 0.20;\n        }\n        \n        \/\/ Convertir a array indexado y ordenar\n        $pedidos_por_dia = array_values($pedidos_por_dia_completo);\n    } else {\n        $pedidos_por_dia = [];\n        $total_dias = 0;\n        $total_paginas_dias = 0;\n    }\n\n    \/* ==========================================================\n       3. Lista de mensajeros para filtro (solo admin)\n    ========================================================== *\/\n    $mensajeros = [];\n    if ($es_admin) {\n        $mensajeros = $wpdb->get_results(\n            \"SELECT id, nombre \n             FROM usuarios_gofast\n             WHERE rol = 'mensajero' AND activo = 1\n             ORDER BY nombre ASC\n            \"\n        );\n    }\n    \n\n    \/* ==========================================================\n       4. Exportar a CSV\n    ========================================================== *\/\n    if (isset($_GET['export']) && $_GET['export'] === 'csv') {\n        header('Content-Type: text\/csv; charset=utf-8');\n        header('Content-Disposition: attachment; filename=\"reporte_pedidos_' . gofast_date_today() . '.csv\"');\n        \n        $output = fopen('php:\/\/output', 'w');\n        \n        \/\/ BOM para Excel\n        fprintf($output, chr(0xEF).chr(0xBB).chr(0xBF));\n        \n        \/\/ Encabezados\n        fputcsv($output, ['ID', 'Fecha', 'Cliente', 'Tel\u00e9fono', 'Origen', 'Total', 'Estado', 'Mensajero']);\n        \n        \/\/ Datos\n        $params_export = $params;\n        $params_export[] = 10000; \/\/ L\u00edmite alto para exportaci\u00f3n\n        \n        $sql_export = $wpdb->prepare(\n            \"SELECT s.*, u.nombre as mensajero_nombre\n             FROM $tabla s\n             LEFT JOIN usuarios_gofast u ON s.mensajero_id = u.id\n             WHERE $where\n             ORDER BY s.fecha DESC\n             LIMIT %d\",\n            $params_export\n        );\n        \n        $pedidos_export = $wpdb->get_results($sql_export);\n        \n        foreach ($pedidos_export as $p) {\n            fputcsv($output, [\n                $p->id,\n                $p->fecha,\n                $p->nombre_cliente,\n                $p->telefono_cliente,\n                $p->direccion_origen,\n                $p->total,\n                $p->tracking_estado,\n                $p->mensajero_nombre ?: 'Sin asignar'\n            ]);\n        }\n        \n        fclose($output);\n        exit;\n    }\n\n    \/* ==========================================================\n       5. HTML\n    ========================================================== *\/\n    ob_start();\n    ?>\n\n<div class=\"gofast-home\">\n    <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;\">\n        <div>\n            <h1 style=\"margin-bottom:8px;\">\ud83d\udcca Reportes y Estad\u00edsticas<\/h1>\n            <p class=\"gofast-home-text\">\n                <?php if ($es_admin): ?>\n                    Analiza el rendimiento de los pedidos y genera reportes detallados.\n                <?php else: ?>\n                    Visualiza tus pedidos y estad\u00edsticas de rendimiento.\n                <?php endif; ?>\n            <\/p>\n        <\/div>\n        <?php if ($es_admin): ?>\n            <a href=\"<?php echo esc_url( home_url('\/dashboard-admin') ); ?>\" class=\"gofast-btn-request\" style=\"text-decoration:none;\">\n                \u2190 Volver al Dashboard\n            <\/a>\n        <?php else: ?>\n            <a href=\"<?php echo esc_url( home_url('\/') ); ?>\" class=\"gofast-btn-request\" style=\"text-decoration:none;\">\n                \u2190 Volver al Inicio\n            <\/a>\n        <?php endif; ?>\n    <\/div>\n\n    <!-- =====================================================\n         A) FILTROS\n    ====================================================== -->\n    <div class=\"gofast-box\" style=\"margin-bottom:20px;\">\n        <form method=\"get\" class=\"gofast-pedidos-filtros\">\n            <div class=\"gofast-pedidos-filtros-row\">\n                <div>\n                    <label>Estado<\/label>\n                    <select name=\"estado\">\n                        <option value=\"todos\"<?php selected($estado, 'todos'); ?>>Todos<\/option>\n                        <option value=\"pendiente\"<?php selected($estado, 'pendiente'); ?>>Pendiente<\/option>\n                        <option value=\"asignado\"<?php selected($estado, 'asignado'); ?>>Asignado<\/option>\n                        <option value=\"en_ruta\"<?php selected($estado, 'en_ruta'); ?>>En Ruta<\/option>\n                        <option value=\"entregado\"<?php selected($estado, 'entregado'); ?>>Entregado<\/option>\n                        <option value=\"cancelado\"<?php selected($estado, 'cancelado'); ?>>Cancelado<\/option>\n                    <\/select>\n                <\/div>\n\n                <div>\n                    <label>Desde<\/label>\n                    <input type=\"date\" name=\"desde\" value=\"<?php echo esc_attr($desde); ?>\">\n                <\/div>\n\n                <div>\n                    <label>Hasta<\/label>\n                    <input type=\"date\" name=\"hasta\" value=\"<?php echo esc_attr($hasta); ?>\">\n                <\/div>\n\n                <?php if ($es_admin): ?>\n                    <div>\n                        <label>Mensajero<\/label>\n                        <select name=\"mensajero_id\" class=\"gofast-select-filtro\" data-placeholder=\"Todos los mensajeros\">\n                            <option value=\"0\">Todos<\/option>\n                            <?php foreach ($mensajeros as $m): ?>\n                                <option value=\"<?= (int) $m->id; ?>\"<?php selected($mensajero_id, $m->id); ?>>\n                                    <?= esc_html($m->nombre); ?>\n                                <\/option>\n                            <?php endforeach; ?>\n                        <\/select>\n                    <\/div>\n                <?php endif; ?>\n\n                <div>\n                    <label>Tipo de Servicio<\/label>\n                    <select name=\"tipo_servicio\">\n                        <option value=\"todos\"<?php selected($tipo_servicio, 'todos'); ?>>Todos<\/option>\n                        <option value=\"normal\"<?php selected($tipo_servicio, 'normal'); ?>>Normal<\/option>\n                        <option value=\"intermunicipal\"<?php selected($tipo_servicio, 'intermunicipal'); ?>>Intermunicipal<\/option>\n                    <\/select>\n                <\/div>\n\n                <div class=\"gofast-pedidos-filtros-actions\">\n                    <button type=\"submit\" class=\"gofast-btn-mini\">Filtrar<\/button>\n                    <a href=\"<?php echo esc_url( get_permalink() ); ?>\" class=\"gofast-btn-mini gofast-btn-outline\">Limpiar<\/a>\n                <\/div>\n            <\/div>\n        <\/form>\n    <\/div>\n\n    <!-- =====================================================\n         B) ESTAD\u00cdSTICAS PRINCIPALES\n    ====================================================== -->\n    <div class=\"gofast-dashboard-stats\" style=\"display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;margin:24px 0;\">\n        \n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">\ud83d\udccd<\/div>\n            <div style=\"font-size:28px;font-weight:700;color:#F4C524;margin-bottom:4px;\"><?= number_format($total_destinos); ?><\/div>\n            <div style=\"font-size:13px;color:#666;\">Total Destinos<\/div>\n        <\/div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">\ud83d\uded2<\/div>\n            <div style=\"font-size:28px;font-weight:700;color:#2196F3;margin-bottom:4px;\"><?= number_format($total_compras); ?><\/div>\n            <div style=\"font-size:13px;color:#666;\">Total Compras<\/div>\n        <\/div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">\ud83d\udcb0<\/div>\n            <div style=\"font-size:28px;font-weight:700;color:#4CAF50;margin-bottom:4px;\">$<?= number_format($total_ingresos, 0, ',', '.'); ?><\/div>\n            <div style=\"font-size:13px;color:#666;\">Ingresos Totales<\/div>\n        <\/div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">\ud83d\udcb5<\/div>\n            <div style=\"font-size:28px;font-weight:700;color:#9C27B0;margin-bottom:4px;\">$<?= number_format($comision_generada, 0, ',', '.'); ?><\/div>\n            <div style=\"font-size:13px;color:#666;\">Comisi\u00f3n Generada (20%)<\/div>\n        <\/div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">\ud83d\udcc8<\/div>\n            <div style=\"font-size:28px;font-weight:700;color:#00BCD4;margin-bottom:4px;\">$<?= number_format($utilidad_neta, 0, ',', '.'); ?><\/div>\n            <div style=\"font-size:13px;color:#666;\">Utilidad Neta<\/div>\n        <\/div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">\ud83d\udccb<\/div>\n            <div style=\"font-size:28px;font-weight:700;color:#FF5722;margin-bottom:4px;\"><?= number_format($pedidos_sin_asignar); ?><\/div>\n            <div style=\"font-size:13px;color:#666;\">Pedidos sin Asignar<\/div>\n        <\/div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">\ud83d\udcb8<\/div>\n            <div style=\"font-size:28px;font-weight:700;color:#FF9800;margin-bottom:4px;\">$<?= number_format($transferencias_aprobadas, 0, ',', '.'); ?><\/div>\n            <div style=\"font-size:13px;color:#666;\">Transferencias Aprobadas<\/div>\n        <\/div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">\ud83d\udcb3<\/div>\n            <div style=\"font-size:28px;font-weight:700;color:<?= $total_a_pagar >= 0 ? '#4CAF50' : '#f44336'; ?>;margin-bottom:4px;\">$<?= number_format($total_a_pagar, 0, ',', '.'); ?><\/div>\n            <div style=\"font-size:13px;color:#666;\">Total a Pagar<\/div>\n        <\/div>\n\n    <\/div>\n\n    <!-- =====================================================\n         B2) PEDIDOS DEL D\u00cdA ACTUAL\n    ====================================================== -->\n    <?php if (!empty($pedidos_hoy) || $total_pedidos_hoy > 0): ?>\n        <div class=\"gofast-box\" style=\"margin-bottom:20px;\">\n            <h3 style=\"margin-top:0;\">\n                \ud83d\udcc5 Pedidos del D\u00eda Actual (<?= gofast_date_format($fecha_hoy, 'd\/m\/Y'); ?>)\n                <span style=\"font-size:14px;color:#666;font-weight:normal;\">\n                    (<?= number_format($total_pedidos_hoy); ?> registro(s) total(es))\n                <\/span>\n            <\/h3>\n            <div style=\"margin-bottom:10px;padding:8px;background:#f0f7ff;border-left:3px solid #2196F3;border-radius:4px;font-size:12px;color:#1976D2;\">\n                \ud83d\udca1 <strong>En m\u00f3vil:<\/strong> Desliza horizontalmente para ver todas las columnas\n            <\/div>\n            <div class=\"gofast-table-wrap\" style=\"width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;display:block;\">\n                <table class=\"gofast-table\" style=\"min-width:800px;width:100%;\">\n                    <thead>\n                        <tr>\n                            <th># Servicio<\/th>\n                            <th>Fecha<\/th>\n                            <th>Origen<\/th>\n                            <th>Destino<\/th>\n                            <?php if ($es_admin): ?>\n                                <th>Mensajero<\/th>\n                            <?php endif; ?>\n                            <th>Total<\/th>\n                        <\/tr>\n                    <\/thead>\n                    <tbody>\n                        <?php foreach ($pedidos_hoy as $pedido): \n                            $json_destinos = json_decode($pedido->destinos, true);\n                            $destinos_array = $json_destinos['destinos'] ?? [];\n                            $primer_destino = !empty($destinos_array) ? $destinos_array[0] : null;\n                            $destino_texto = '';\n                            if ($primer_destino) {\n                                $destino_texto = !empty($primer_destino['barrio_nombre']) \n                                    ? $primer_destino['barrio_nombre'] \n                                    : (!empty($primer_destino['direccion']) ? $primer_destino['direccion'] : 'N\/A');\n                                if (count($destinos_array) > 1) {\n                                    $destino_texto .= ' +' . (count($destinos_array) - 1) . ' m\u00e1s';\n                                }\n                            }\n                            \n                            \/\/ Obtener nombre del mensajero si existe\n                            $mensajero_nombre = '';\n                            if ($pedido->mensajero_id) {\n                                $mensajero = $wpdb->get_row($wpdb->prepare(\n                                    \"SELECT nombre FROM usuarios_gofast WHERE id = %d\",\n                                    $pedido->mensajero_id\n                                ));\n                                $mensajero_nombre = $mensajero ? $mensajero->nombre : 'N\/A';\n                            }\n                        ?>\n                            <tr>\n                                <td>#<?= (int) $pedido->id; ?><\/td>\n                                <td><?= esc_html( gofast_date_format($pedido->fecha, 'H:i') ); ?><\/td>\n                                <td><?= esc_html($pedido->direccion_origen); ?><\/td>\n                                <td><?= esc_html($destino_texto ?: 'N\/A'); ?><\/td>\n                                <?php if ($es_admin): ?>\n                                    <td><?= esc_html($mensajero_nombre ?: 'Sin asignar'); ?><\/td>\n                                <?php endif; ?>\n                                <td>$<?= number_format($pedido->total, 0, ',', '.'); ?><\/td>\n                            <\/tr>\n                        <?php endforeach; ?>\n                    <\/tbody>\n                <\/table>\n            <\/div>\n            \n            <?php if ($total_paginas_pedidos > 1): ?>\n                <div class=\"gofast-pagination\" style=\"margin-top:20px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center;\">\n                    <?php\n                    $base_url_pedidos = get_permalink();\n                    $query_args_pedidos = $_GET;\n                    for ($i = 1; $i <= $total_paginas_pedidos; $i++):\n                        $query_args_pedidos['pg_pedidos'] = $i;\n                        $url_pedidos = esc_url( add_query_arg($query_args_pedidos, $base_url_pedidos) );\n                        $active_pedidos = ($i === $pg_pedidos) ? 'gofast-page-current' : '';\n                        ?>\n                        <a href=\"<?php echo $url_pedidos; ?>\" class=\"gofast-page-link <?php echo $active_pedidos; ?>\" style=\"padding:8px 12px;border:1px solid #ddd;border-radius:6px;text-decoration:none;color:#333;background:#fff;<?php echo $active_pedidos ? 'background:var(--gofast-yellow);font-weight:700;' : ''; ?>\">\n                            <?php echo $i; ?>\n                        <\/a>\n                    <?php endfor; ?>\n                <\/div>\n            <?php endif; ?>\n        <\/div>\n    <?php else: ?>\n        <div class=\"gofast-box\" style=\"margin-bottom:20px;\">\n            <h3 style=\"margin-top:0;\">\ud83d\udcc5 Pedidos del D\u00eda Actual (<?= gofast_date_format($fecha_hoy, 'd\/m\/Y'); ?>)<\/h3>\n            <p>No hay pedidos registrados para el d\u00eda de hoy.<\/p>\n        <\/div>\n    <?php endif; ?>\n\n    <!-- =====================================================\n         B3) COMPRAS DEL D\u00cdA ACTUAL\n    ====================================================== -->\n    <?php if (!empty($compras_hoy) || $total_compras_hoy > 0): ?>\n        <div class=\"gofast-box\" style=\"margin-bottom:20px;\">\n            <h3 style=\"margin-top:0;\">\n                \ud83d\uded2 Compras del D\u00eda Actual (<?= gofast_date_format($fecha_hoy, 'd\/m\/Y'); ?>)\n                <span style=\"font-size:14px;color:#666;font-weight:normal;\">\n                    (<?= number_format($total_compras_hoy); ?> compra(s) total(es))\n                <\/span>\n            <\/h3>\n            <div style=\"margin-bottom:10px;padding:8px;background:#f0f7ff;border-left:3px solid #2196F3;border-radius:4px;font-size:12px;color:#1976D2;\">\n                \ud83d\udca1 <strong>En m\u00f3vil:<\/strong> Desliza horizontalmente para ver todas las columnas\n            <\/div>\n            <div class=\"gofast-table-wrap\" style=\"width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;display:block;\">\n                <table class=\"gofast-table\" style=\"min-width:800px;width:100%;\">\n                    <thead>\n                        <tr>\n                            <th>ID<\/th>\n                            <th>Hora<\/th>\n                            <?php if ($es_admin): ?>\n                                <th>Mensajero<\/th>\n                                <th>Creado por<\/th>\n                            <?php endif; ?>\n                            <th>Valor<\/th>\n                            <th>Destino<\/th>\n                            <th>Estado<\/th>\n                            <th>Observaciones<\/th>\n                        <\/tr>\n                    <\/thead>\n                    <tbody>\n                        <?php foreach ($compras_hoy as $compra): ?>\n                            <tr>\n                                <td>#<?= (int) $compra->id; ?><\/td>\n                                <td><?= esc_html( gofast_date_format($compra->fecha_creacion, 'H:i') ); ?><\/td>\n                                <?php if ($es_admin): ?>\n                                    <td>\n                                        <?= esc_html($compra->mensajero_nombre ?: 'N\/A'); ?>\n                                        <?php if ($compra->mensajero_telefono): ?>\n                                            <br><small style=\"color:#666;\"><?= esc_html($compra->mensajero_telefono); ?><\/small>\n                                        <?php endif; ?>\n                                    <\/td>\n                                    <td><?= esc_html($compra->creador_nombre ?: 'N\/A'); ?><\/td>\n                                <?php endif; ?>\n                                <td><strong>$<?= number_format($compra->valor, 0, ',', '.'); ?><\/strong><\/td>\n                                <td><?= esc_html($compra->barrio_nombre ?: 'N\/A'); ?><\/td>\n                                <td>\n                                    <?php\n                                    $estado_compra = $compra->estado;\n                                    $estado_colors = [\n                                        'pendiente' => '#fff3cd',\n                                        'en_proceso' => '#cfe2ff',\n                                        'completada' => '#d4edda',\n                                        'cancelada' => '#f8d7da'\n                                    ];\n                                    $estado_labels = [\n                                        'pendiente' => 'Pendiente',\n                                        'en_proceso' => 'En Proceso',\n                                        'completada' => 'Completada',\n                                        'cancelada' => 'Cancelada'\n                                    ];\n                                    $color = $estado_colors[$estado_compra] ?? '#f8f9fa';\n                                    $label = $estado_labels[$estado_compra] ?? $estado_compra;\n                                    ?>\n                                    <span style=\"display:inline-block;padding:4px 10px;border-radius:4px;background:<?= $color; ?>;font-size:12px;font-weight:600;\">\n                                        <?= esc_html($label); ?>\n                                    <\/span>\n                                <\/td>\n                                <td><?= esc_html($compra->observaciones ?: '\u2014'); ?><\/td>\n                            <\/tr>\n                        <?php endforeach; ?>\n                    <\/tbody>\n                <\/table>\n            <\/div>\n            \n            <?php if ($total_paginas_compras_hoy > 1): ?>\n                <div class=\"gofast-pagination\" style=\"margin-top:20px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center;\">\n                    <?php\n                    $base_url_compras_hoy = get_permalink();\n                    $query_args_compras_hoy = $_GET;\n                    for ($i = 1; $i <= $total_paginas_compras_hoy; $i++):\n                        $query_args_compras_hoy['pg_compras_hoy'] = $i;\n                        $url_compras_hoy = esc_url( add_query_arg($query_args_compras_hoy, $base_url_compras_hoy) );\n                        $active_compras_hoy = ($i === $pg_compras_hoy) ? 'gofast-page-current' : '';\n                        ?>\n                        <a href=\"<?php echo $url_compras_hoy; ?>\" class=\"gofast-page-link <?php echo $active_compras_hoy; ?>\" style=\"padding:8px 12px;border:1px solid #ddd;border-radius:6px;text-decoration:none;color:#333;background:#fff;<?php echo $active_compras_hoy ? 'background:var(--gofast-yellow);font-weight:700;' : ''; ?>\">\n                            <?php echo $i; ?>\n                        <\/a>\n                    <?php endfor; ?>\n                <\/div>\n            <?php endif; ?>\n        <\/div>\n    <?php else: ?>\n        <div class=\"gofast-box\" style=\"margin-bottom:20px;\">\n            <h3 style=\"margin-top:0;\">\ud83d\uded2 Compras del D\u00eda Actual (<?= gofast_date_format($fecha_hoy, 'd\/m\/Y'); ?>)<\/h3>\n            <p>No hay compras registradas para el d\u00eda de hoy.<\/p>\n        <\/div>\n    <?php endif; ?>\n\n    <!-- =====================================================\n         C) TOP MENSAJEROS (Solo Admin)\n    ====================================================== -->\n    <?php if ($es_admin && !empty($top_mensajeros)): ?>\n        <div class=\"gofast-box\" style=\"margin-bottom:20px;\">\n            <h3 style=\"margin-top:0;\">\ud83c\udfc6 Top Mensajeros<\/h3>\n            <div style=\"margin-bottom:10px;padding:8px;background:#f0f7ff;border-left:3px solid #2196F3;border-radius:4px;font-size:12px;color:#1976D2;\">\n                \ud83d\udca1 <strong>En m\u00f3vil:<\/strong> Desliza horizontalmente para ver todas las columnas\n            <\/div>\n            <div class=\"gofast-table-wrap\" style=\"width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;display:block;\">\n                <table class=\"gofast-table\" style=\"min-width:600px;width:100%;\">\n                    <thead>\n                        <tr>\n                            <th>#<\/th>\n                            <th>Mensajero<\/th>\n                            <th>Pedidos Entregados<\/th>\n                            <th>Total Ingresos<\/th>\n                        <\/tr>\n                    <\/thead>\n                    <tbody>\n                        <?php foreach ($top_mensajeros as $idx => $m): ?>\n                            <tr>\n                                <td><?= $idx + 1; ?><\/td>\n                                <td><?= esc_html($m->nombre); ?><\/td>\n                                <td><?= number_format($m->total_entregados); ?><\/td>\n                                <td>$<?= number_format($m->total_ingresos, 0, ',', '.'); ?><\/td>\n                            <\/tr>\n                        <?php endforeach; ?>\n                    <\/tbody>\n                <\/table>\n            <\/div>\n            \n            <?php if ($total_paginas_mensajeros > 1): ?>\n                <div class=\"gofast-pagination\" style=\"margin-top:20px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center;\">\n                    <?php\n                    $base_url_mensajeros = get_permalink();\n                    $query_args_mensajeros = $_GET;\n                    for ($i = 1; $i <= $total_paginas_mensajeros; $i++):\n                        $query_args_mensajeros['pg_mensajeros'] = $i;\n                        $url_mensajeros = esc_url( add_query_arg($query_args_mensajeros, $base_url_mensajeros) );\n                        $active_mensajeros = ($i === $pg_mensajeros) ? 'gofast-page-current' : '';\n                        ?>\n                        <a href=\"<?php echo $url_mensajeros; ?>\" class=\"gofast-page-link <?php echo $active_mensajeros; ?>\" style=\"padding:8px 12px;border:1px solid #ddd;border-radius:6px;text-decoration:none;color:#333;background:#fff;<?php echo $active_mensajeros ? 'background:var(--gofast-yellow);font-weight:700;' : ''; ?>\">\n                            <?php echo $i; ?>\n                        <\/a>\n                    <?php endfor; ?>\n                <\/div>\n            <?php endif; ?>\n        <\/div>\n    <?php endif; ?>\n\n    <!-- =====================================================\n         D) PEDIDOS POR D\u00cdA (\u00daLTIMOS 30 D\u00cdAS)\n    ====================================================== -->\n    <?php if (!empty($pedidos_por_dia)): ?>\n        <div class=\"gofast-box\" style=\"margin-bottom:20px;\">\n            <h3 style=\"margin-top:0;\">\ud83d\udcc8 Pedidos por D\u00eda (\u00daltimos 30 d\u00edas)<\/h3>\n            <div style=\"margin-bottom:10px;padding:8px;background:#f0f7ff;border-left:3px solid #2196F3;border-radius:4px;font-size:12px;color:#1976D2;\">\n                \ud83d\udca1 <strong>En m\u00f3vil:<\/strong> Desliza horizontalmente para ver todas las columnas\n            <\/div>\n            <div class=\"gofast-table-wrap\" style=\"width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;display:block;\">\n                <table class=\"gofast-table\" style=\"min-width:700px;width:100%;\">\n                    <thead>\n                        <tr>\n                            <th>Fecha<\/th>\n                            <th>Cantidad de Destinos<\/th>\n                            <th>Cantidad de Compras<\/th>\n                            <th>Ingresos<\/th>\n                            <th>Comisi\u00f3n<\/th>\n                        <\/tr>\n                    <\/thead>\n                    <tbody>\n                        <?php foreach ($pedidos_por_dia as $dia): ?>\n                            <tr>\n                                <td><?= esc_html( gofast_date_format($dia['dia'], 'd\/m\/Y') ); ?><\/td>\n                                <td><?= number_format($dia['cantidad_destinos']); ?><\/td>\n                                <td><?= number_format($dia['cantidad_compras']); ?><\/td>\n                                <td>$<?= number_format($dia['ingresos'], 0, ',', '.'); ?><\/td>\n                                <td>$<?= number_format($dia['comision'], 0, ',', '.'); ?><\/td>\n                            <\/tr>\n                        <?php endforeach; ?>\n                    <\/tbody>\n                <\/table>\n            <\/div>\n            \n            <?php if ($total_paginas_dias > 1): ?>\n                <div class=\"gofast-pagination\" style=\"margin-top:20px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center;\">\n                    <?php\n                    $base_url_dias = get_permalink();\n                    $query_args_dias = $_GET;\n                    for ($i = 1; $i <= $total_paginas_dias; $i++):\n                        $query_args_dias['pg_dias'] = $i;\n                        $url_dias = esc_url( add_query_arg($query_args_dias, $base_url_dias) );\n                        $active_dias = ($i === $pg_dias) ? 'gofast-page-current' : '';\n                        ?>\n                        <a href=\"<?php echo $url_dias; ?>\" class=\"gofast-page-link <?php echo $active_dias; ?>\" style=\"padding:8px 12px;border:1px solid #ddd;border-radius:6px;text-decoration:none;color:#333;background:#fff;<?php echo $active_dias ? 'background:var(--gofast-yellow);font-weight:700;' : ''; ?>\">\n                            <?php echo $i; ?>\n                        <\/a>\n                    <?php endfor; ?>\n                <\/div>\n            <?php endif; ?>\n        <\/div>\n    <?php endif; ?>\n\n<\/div>\n\n<script>\n(function() {\n    \/\/ Asegurar que las funciones normalize y matcherDestinos est\u00e9n disponibles\n    if (typeof window.normalize === 'undefined') {\n        window.normalize = function(s) {\n            return (s || \"\")\n                .toLowerCase()\n                .normalize('NFD')\n                .replace(\/[\\u0300-\\u036f]\/g, '')\n                .trim();\n        };\n    }\n    \n    if (typeof window.matcherDestinos === 'undefined') {\n        window.matcherDestinos = function(params, data) {\n            if (!data) return null;\n            \n            if (data.children && Array.isArray(data.children)) {\n                return data;\n            }\n            \n            if (!data.id) {\n                if (!params.term || !params.term.trim()) {\n                    return data;\n                }\n                return null;\n            }\n            \n            if (!data.text) return null;\n            \n            if (!params.term || !params.term.trim()) {\n                data.matchScore = 0;\n                return data;\n            }\n\n            const term = window.normalize(params.term);\n            if (!term) {\n                data.matchScore = 0;\n                return data;\n            }\n\n            const text = window.normalize(data.text);\n            \n            if (text === term) {\n                data.matchScore = 10000;\n                return data;\n            }\n            \n            if (text.indexOf(term) === 0) {\n                data.matchScore = 9500;\n                return data;\n            }\n            \n            const stopWords = ['las', 'los', 'la', 'el', 'de', 'del', 'en', 'un', 'una', 'y', 'o'];\n            \n            const searchWords = term.split(\/\\s+\/).filter(Boolean).filter(word => {\n                return word.length > 2 && !stopWords.includes(word);\n            });\n            \n            if (searchWords.length === 0) {\n                if (text.indexOf(term) !== -1) {\n                    data.matchScore = 7000;\n                    return data;\n                }\n                return null;\n            }\n            \n            const significantMatches = searchWords.filter(word => {\n                if (word.length <= 2) {\n                    return text.split(\/\\s+\/).some(textWord => textWord.indexOf(word) === 0);\n                }\n                return text.indexOf(word) !== -1;\n            });\n            \n            if (significantMatches.length === 0) return null;\n            \n            const allSignificantMatch = searchWords.length === significantMatches.length;\n            \n            let score = 0;\n            \n            const textWithoutStopWords = text.split(\/\\s+\/).filter(w => !stopWords.includes(w)).join(' ');\n            const termWithoutStopWords = searchWords.join(' ');\n            \n            if (textWithoutStopWords === termWithoutStopWords) {\n                score = 10000;\n            } else if (textWithoutStopWords.indexOf(termWithoutStopWords) === 0) {\n                score = 9000;\n            } else if (textWithoutStopWords.indexOf(termWithoutStopWords) !== -1) {\n                score = 8000;\n            } else if (searchWords.some(word => text.indexOf(word) === 0)) {\n                score = 7000;\n            } else if (text.indexOf(term) !== -1) {\n                score = 6000;\n            } else {\n                score = allSignificantMatch ? 5000 : 3000;\n                \n                let lastIndex = -1;\n                let wordsInOrder = true;\n                searchWords.forEach(word => {\n                    const wordIndex = text.indexOf(word, lastIndex + 1);\n                    if (wordIndex === -1) {\n                        wordsInOrder = false;\n                    } else {\n                        if (wordIndex < lastIndex) wordsInOrder = false;\n                        lastIndex = wordIndex;\n                        if (text.indexOf(word) === 0) score += 500;\n                    }\n                });\n                \n                if (wordsInOrder) score += 1000;\n            }\n            \n            data.matchScore = score;\n            return data;\n        };\n    }\n    \n    \/\/ Inicializar Select2 para filtro de mensajero\n    if (window.jQuery && jQuery.fn.select2 && typeof window.matcherDestinos === 'function' && typeof window.normalize === 'function') {\n        jQuery('.gofast-select-filtro').each(function() {\n            if (jQuery(this).data('select2')) {\n                return;\n            }\n            \n            jQuery(this).select2({\n                placeholder: function() {\n                    return jQuery(this).data('placeholder') || '\ud83d\udd0d Escribe para buscar...';\n                },\n                width: '100%',\n                allowClear: false,\n                minimumResultsForSearch: 0,\n                matcher: window.matcherDestinos,\n                sorter: function(results) {\n                    return results.sort(function(a, b) {\n                        return (b.matchScore || 0) - (a.matchScore || 0);\n                    });\n                },\n                templateResult: function(data, container) {\n                    if (!data || !data.text) {\n                        return data ? data.text : '';\n                    }\n                    \n                    if (!data.id) return data.text;\n                    \n                    let originalText = data.text;\n                    let searchTerm = \"\";\n                    const $activeField = jQuery('.select2-container--open .select2-search__field');\n                    if ($activeField.length) {\n                        searchTerm = $activeField.val() || \"\";\n                    }\n                    \n                    if (!searchTerm || !searchTerm.trim()) {\n                        const $result = jQuery('<span>').text(originalText);\n                        if (data.matchScore !== undefined) {\n                            $result.attr('data-match-score', data.matchScore);\n                        }\n                        return $result;\n                    }\n                    \n                    const normalizedSearch = window.normalize(searchTerm);\n                    const normalizedText = window.normalize(originalText);\n                    const stopWords = ['las', 'los', 'la', 'el', 'de', 'del', 'en', 'un', 'una', 'y', 'o'];\n                    const searchWords = normalizedSearch.split(\/\\s+\/).filter(Boolean).filter(word => {\n                        return word.length > 2 && !stopWords.includes(word);\n                    });\n                    const wordsToHighlight = searchWords.length > 0 ? searchWords : [normalizedSearch];\n                    const highlightRanges = [];\n                    \n                    wordsToHighlight.forEach(function(word) {\n                        let searchPos = 0;\n                        while ((searchPos = normalizedText.indexOf(word, searchPos)) !== -1) {\n                            const endPos = searchPos + word.length;\n                            let origStart = -1;\n                            let origEnd = -1;\n                            let normPos = 0;\n                            \n                            for (let i = 0; i < originalText.length && origStart === -1; i++) {\n                                const charNorm = window.normalize(originalText[i]);\n                                if (normPos === searchPos) {\n                                    origStart = i;\n                                }\n                                normPos += charNorm.length;\n                            }\n                            \n                            if (origStart >= 0) {\n                                normPos = searchPos;\n                                for (let i = origStart; i < originalText.length; i++) {\n                                    const charNorm = window.normalize(originalText[i]);\n                                    normPos += charNorm.length;\n                                    if (normPos >= endPos) {\n                                        origEnd = i + 1;\n                                        break;\n                                    }\n                                }\n                                \n                                if (origStart >= 0 && origEnd > origStart) {\n                                    highlightRanges.push({ start: origStart, end: origEnd });\n                                }\n                            }\n                            \n                            searchPos = endPos;\n                        }\n                    });\n                    \n                    if (highlightRanges.length > 0) {\n                        highlightRanges.sort((a, b) => a.start - b.start);\n                        const mergedRanges = [highlightRanges[0]];\n                        \n                        for (let i = 1; i < highlightRanges.length; i++) {\n                            const current = highlightRanges[i];\n                            const last = mergedRanges[mergedRanges.length - 1];\n                            \n                            if (current.start <= last.end) {\n                                last.end = Math.max(last.end, current.end);\n                            } else {\n                                mergedRanges.push(current);\n                            }\n                        }\n                        \n                        const parts = [];\n                        let lastIndex = 0;\n                        \n                        mergedRanges.forEach(function(range) {\n                            if (range.start > lastIndex) {\n                                parts.push(originalText.substring(lastIndex, range.start));\n                            }\n                            \n                            const matchText = originalText.substring(range.start, range.end);\n                            parts.push('<span style=\"background-color:#F4C524;color:#000;font-weight:bold;padding:1px 2px;\">' + \n                                       matchText + '<\/span>');\n                            \n                            lastIndex = range.end;\n                        });\n                        \n                        if (lastIndex < originalText.length) {\n                            parts.push(originalText.substring(lastIndex));\n                        }\n                        \n                        const result = parts.join('');\n                        const $result = jQuery('<span>').html(result);\n                        if (data.matchScore !== undefined) {\n                            $result.attr('data-match-score', data.matchScore);\n                        }\n                        return $result;\n                    }\n                    \n                    const $result = jQuery('<span>').text(originalText);\n                    if (data.matchScore !== undefined) {\n                        $result.attr('data-match-score', data.matchScore);\n                    }\n                    return $result;\n                }\n            }).on('select2:open', function(e) {\n                setTimeout(function() {\n                    const $dropdown = jQuery('.select2-dropdown');\n                    const $searchContainer = $dropdown.find('.select2-search--dropdown');\n                    const $searchField = $searchContainer.find('.select2-search__field');\n                    \n                    if ($searchContainer.length) {\n                        $searchContainer.css({\n                            'display': 'block',\n                            'visibility': 'visible',\n                            'opacity': '1'\n                        });\n                    }\n                    \n                    if ($searchField.length) {\n                        $searchField.css({\n                            'display': 'block',\n                            'visibility': 'visible',\n                            'opacity': '1'\n                        });\n                        \n                        setTimeout(function() {\n                            $searchField.focus();\n                        }, 100);\n                    }\n                }, 50);\n            });\n        });\n        \n        \/\/ Ocultar select original cuando Select2 est\u00e1 activo\n        jQuery('.gofast-select-filtro').each(function() {\n            if (jQuery(this).data('select2')) {\n                jQuery(this).css({\n                    'visibility': 'hidden',\n                    'position': 'absolute',\n                    'width': '1px',\n                    'height': '1px',\n                    'opacity': '0',\n                    'pointer-events': 'none'\n                });\n            }\n        });\n    } else {\n        \/\/ Reintentar despu\u00e9s de un breve delay\n        setTimeout(function() {\n            if (window.jQuery && jQuery.fn.select2 && typeof window.matcherDestinos === 'function' && typeof window.normalize === 'function') {\n                jQuery('.gofast-select-filtro').each(function() {\n                    if (jQuery(this).data('select2')) {\n                        return;\n                    }\n                    \n                    jQuery(this).select2({\n                        placeholder: function() {\n                            return jQuery(this).data('placeholder') || '\ud83d\udd0d Escribe para buscar...';\n                        },\n                        width: '100%',\n                        allowClear: false,\n                        minimumResultsForSearch: 0,\n                        matcher: window.matcherDestinos,\n                        sorter: function(results) {\n                            return results.sort(function(a, b) {\n                                return (b.matchScore || 0) - (a.matchScore || 0);\n                            });\n                        },\n                        templateResult: function(data, container) {\n                            if (!data || !data.text) {\n                                return data ? data.text : '';\n                            }\n                            \n                            if (!data.id) return data.text;\n                            \n                            let originalText = data.text;\n                            let searchTerm = \"\";\n                            const $activeField = jQuery('.select2-container--open .select2-search__field');\n                            if ($activeField.length) {\n                                searchTerm = $activeField.val() || \"\";\n                            }\n                            \n                            if (!searchTerm || !searchTerm.trim()) {\n                                const $result = jQuery('<span>').text(originalText);\n                                if (data.matchScore !== undefined) {\n                                    $result.attr('data-match-score', data.matchScore);\n                                }\n                                return $result;\n                            }\n                            \n                            const normalizedSearch = window.normalize(searchTerm);\n                            const normalizedText = window.normalize(originalText);\n                            const stopWords = ['las', 'los', 'la', 'el', 'de', 'del', 'en', 'un', 'una', 'y', 'o'];\n                            const searchWords = normalizedSearch.split(\/\\s+\/).filter(Boolean).filter(word => {\n                                return word.length > 2 && !stopWords.includes(word);\n                            });\n                            const wordsToHighlight = searchWords.length > 0 ? searchWords : [normalizedSearch];\n                            const highlightRanges = [];\n                            \n                            wordsToHighlight.forEach(function(word) {\n                                let searchPos = 0;\n                                while ((searchPos = normalizedText.indexOf(word, searchPos)) !== -1) {\n                                    const endPos = searchPos + word.length;\n                                    let origStart = -1;\n                                    let origEnd = -1;\n                                    let normPos = 0;\n                                    \n                                    for (let i = 0; i < originalText.length && origStart === -1; i++) {\n                                        const charNorm = window.normalize(originalText[i]);\n                                        if (normPos === searchPos) {\n                                            origStart = i;\n                                        }\n                                        normPos += charNorm.length;\n                                    }\n                                    \n                                    if (origStart >= 0) {\n                                        normPos = searchPos;\n                                        for (let i = origStart; i < originalText.length; i++) {\n                                            const charNorm = window.normalize(originalText[i]);\n                                            normPos += charNorm.length;\n                                            if (normPos >= endPos) {\n                                                origEnd = i + 1;\n                                                break;\n                                            }\n                                        }\n                                        \n                                        if (origStart >= 0 && origEnd > origStart) {\n                                            highlightRanges.push({ start: origStart, end: origEnd });\n                                        }\n                                    }\n                                    \n                                    searchPos = endPos;\n                                }\n                            });\n                            \n                            if (highlightRanges.length > 0) {\n                                highlightRanges.sort((a, b) => a.start - b.start);\n                                const mergedRanges = [highlightRanges[0]];\n                                \n                                for (let i = 1; i < highlightRanges.length; i++) {\n                                    const current = highlightRanges[i];\n                                    const last = mergedRanges[mergedRanges.length - 1];\n                                    \n                                    if (current.start <= last.end) {\n                                        last.end = Math.max(last.end, current.end);\n                                    } else {\n                                        mergedRanges.push(current);\n                                    }\n                                }\n                                \n                                const parts = [];\n                                let lastIndex = 0;\n                                \n                                mergedRanges.forEach(function(range) {\n                                    if (range.start > lastIndex) {\n                                        parts.push(originalText.substring(lastIndex, range.start));\n                                    }\n                                    \n                                    const matchText = originalText.substring(range.start, range.end);\n                                    parts.push('<span style=\"background-color:#F4C524;color:#000;font-weight:bold;padding:1px 2px;\">' + \n                                               matchText + '<\/span>');\n                                    \n                                    lastIndex = range.end;\n                                });\n                                \n                                if (lastIndex < originalText.length) {\n                                    parts.push(originalText.substring(lastIndex));\n                                }\n                                \n                                const result = parts.join('');\n                                const $result = jQuery('<span>').html(result);\n                                if (data.matchScore !== undefined) {\n                                    $result.attr('data-match-score', data.matchScore);\n                                }\n                                return $result;\n                            }\n                            \n                            const $result = jQuery('<span>').text(originalText);\n                            if (data.matchScore !== undefined) {\n                                $result.attr('data-match-score', data.matchScore);\n                            }\n                            return $result;\n                        }\n                    }).on('select2:open', function(e) {\n                        setTimeout(function() {\n                            const $dropdown = jQuery('.select2-dropdown');\n                            const $searchContainer = $dropdown.find('.select2-search--dropdown');\n                            const $searchField = $searchContainer.find('.select2-search__field');\n                            \n                            if ($searchContainer.length) {\n                                $searchContainer.css({\n                                    'display': 'block',\n                                    'visibility': 'visible',\n                                    'opacity': '1'\n                                });\n                            }\n                            \n                            if ($searchField.length) {\n                                $searchField.css({\n                                    'display': 'block',\n                                    'visibility': 'visible',\n                                    'opacity': '1'\n                                });\n                                \n                                setTimeout(function() {\n                                    $searchField.focus();\n                                }, 100);\n                            }\n                        }, 50);\n                    });\n                });\n                \n                \/\/ Ocultar select original\n                jQuery('.gofast-select-filtro').each(function() {\n                    if (jQuery(this).data('select2')) {\n                        jQuery(this).css({\n                            'visibility': 'hidden',\n                            'position': 'absolute',\n                            'width': '1px',\n                            'height': '1px',\n                            'opacity': '0',\n                            'pointer-events': 'none'\n                        });\n                    }\n                });\n            }\n        }, 500);\n    }\n})();\n<\/script>\n\n<?php\n    return ob_get_clean();\n}\nadd_shortcode('gofast_reportes_admin', 'gofast_reportes_admin_shortcode');\n?>\n\n<style>\n\/* Responsive para m\u00f3vil - tablas de reportes *\/\n@media (max-width: 768px) {\n    \n    \/* Asegurar que las tablas sean visibles y scrollables en m\u00f3vil *\/\n    .gofast-table-wrap {\n        overflow-x: auto !important;\n        -webkit-overflow-scrolling: touch !important;\n        scrollbar-width: thin !important;\n        width: 100% !important;\n        max-width: 100% !important;\n        display: block !important;\n        visibility: visible !important;\n        margin: 0 !important;\n        padding: 0 !important;\n        position: relative !important;\n    }\n    \n    .gofast-table-wrap::-webkit-scrollbar {\n        height: 12px !important;\n    }\n    \n    .gofast-table-wrap::-webkit-scrollbar-track {\n        background: #e0e0e0 !important;\n        border-radius: 6px !important;\n    }\n    \n    .gofast-table-wrap::-webkit-scrollbar-thumb {\n        background: #2196F3 !important;\n        border-radius: 6px !important;\n        border: 2px solid #e0e0e0 !important;\n    }\n    \n    .gofast-table-wrap::-webkit-scrollbar-thumb:hover {\n        background: #1976D2 !important;\n    }\n    \n    .gofast-table {\n        font-size: 13px !important;\n        display: table !important;\n        visibility: visible !important;\n        width: 100% !important;\n        table-layout: auto !important;\n        border-collapse: collapse !important;\n        border-spacing: 0 !important;\n    }\n    \n    .gofast-table th,\n    .gofast-table td {\n        padding: 12px 10px !important;\n        font-size: 13px !important;\n        white-space: nowrap !important;\n        display: table-cell !important;\n        visibility: visible !important;\n        text-align: left !important;\n        border-bottom: 1px solid #e0e0e0 !important;\n        vertical-align: middle !important;\n    }\n    \n    .gofast-table th {\n        background: #f5f5f5 !important;\n        font-weight: 600 !important;\n        color: #333 !important;\n        border-bottom: 2px solid #ddd !important;\n    }\n    \n    .gofast-table tbody tr {\n        background: #fff !important;\n    }\n    \n    .gofast-table tbody tr:hover {\n        background: #f9f9f9 !important;\n    }\n    \n    .gofast-table tbody tr:last-child td {\n        border-bottom: none !important;\n    }\n    \n    \/* Mejorar visibilidad del scroll en m\u00f3vil *\/\n    .gofast-box .gofast-table-wrap {\n        border: 1px solid #e0e0e0 !important;\n        border-radius: 8px !important;\n        background: #fff !important;\n        position: relative !important;\n    }\n    \n    \n    \/* Asegurar que las tablas tengan el ancho m\u00ednimo correcto *\/\n    .gofast-table[style*=\"min-width:800px\"] {\n        min-width: 800px !important;\n    }\n    \n    .gofast-table[style*=\"min-width:700px\"] {\n        min-width: 700px !important;\n    }\n    \n    .gofast-table[style*=\"min-width:600px\"] {\n        min-width: 600px !important;\n    }\n    \n    \/* Ajustar tarjetas de estad\u00edsticas en m\u00f3vil - scroll horizontal *\/\n    .gofast-dashboard-stats {\n        display: grid !important;\n        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)) !important;\n        gap: 12px !important;\n        overflow-x: auto !important;\n        -webkit-overflow-scrolling: touch !important;\n        padding-bottom: 8px !important;\n    }\n    \n    .gofast-dashboard-stats::-webkit-scrollbar {\n        height: 6px;\n    }\n    \n    .gofast-dashboard-stats::-webkit-scrollbar-track {\n        background: #f1f1f1;\n        border-radius: 4px;\n    }\n    \n    .gofast-dashboard-stats::-webkit-scrollbar-thumb {\n        background: #888;\n        border-radius: 4px;\n    }\n    \n    .gofast-dashboard-stats .gofast-box {\n        min-width: 160px !important;\n        flex-shrink: 0 !important;\n    }\n    \n    .gofast-dashboard-stats .gofast-box {\n        padding: 16px !important;\n    }\n    \n    .gofast-dashboard-stats .gofast-box > div:first-child {\n        font-size: 24px !important;\n    }\n    \n    .gofast-dashboard-stats .gofast-box > div:nth-child(2) {\n        font-size: 22px !important;\n    }\n    \n    \/* Ajustar filtros en m\u00f3vil *\/\n    .gofast-pedidos-filtros-row {\n        flex-direction: column !important;\n        gap: 12px !important;\n        align-items: stretch !important;\n    }\n    \n    .gofast-pedidos-filtros-row > div {\n        width: 100% !important;\n        min-width: 100% !important;\n        max-width: 100% !important;\n    }\n    \n    .gofast-pedidos-filtros label {\n        margin-bottom: 4px !important;\n    }\n    \n    .gofast-pedidos-filtros input,\n    .gofast-pedidos-filtros select {\n        height: 46px !important;\n        font-size: 16px !important;\n    }\n    \n    .gofast-pedidos-filtros .gofast-select-filtro + .select2-container .select2-selection--single {\n        height: 46px !important;\n    }\n    \n    .gofast-pedidos-filtros .gofast-select-filtro + .select2-container .select2-selection__rendered {\n        line-height: 46px !important;\n    }\n    \n    .gofast-pedidos-filtros-actions {\n        flex-direction: column !important;\n        width: 100% !important;\n        gap: 8px !important;\n    }\n    \n    .gofast-pedidos-filtros-actions button,\n    .gofast-pedidos-filtros-actions a {\n        width: 100% !important;\n        text-align: center !important;\n        height: 46px !important;\n    }\n    \n    \/* Ajustar encabezado en m\u00f3vil *\/\n    .gofast-home > div:first-child {\n        flex-direction: column !important;\n        align-items: flex-start !important;\n        gap: 12px !important;\n    }\n    \n    .gofast-home > div:first-child > div:first-child h1 {\n        font-size: 24px !important;\n    }\n    \n    .gofast-home > div:first-child > a {\n        width: 100% !important;\n        text-align: center !important;\n    }\n    \n    \/* Estilos para paginaci\u00f3n *\/\n    .gofast-pagination {\n        margin-top: 20px !important;\n        display: flex !important;\n        gap: 8px !important;\n        flex-wrap: wrap !important;\n        justify-content: center !important;\n    }\n    \n    .gofast-page-link {\n        padding: 8px 12px !important;\n        border: 1px solid #ddd !important;\n        border-radius: 6px !important;\n        text-decoration: none !important;\n        color: #333 !important;\n        background: #fff !important;\n        font-size: 14px !important;\n        min-width: 40px !important;\n        text-align: center !important;\n        transition: all 0.2s ease !important;\n    }\n    \n    .gofast-page-link:hover {\n        background: #f5f5f5 !important;\n        border-color: #bbb !important;\n    }\n    \n    .gofast-page-current {\n        background: var(--gofast-yellow, #F4C524) !important;\n        font-weight: 700 !important;\n        border-color: var(--gofast-yellow, #F4C524) !important;\n        color: #000 !important;\n    }\n    \n    @media (max-width: 768px) {\n        .gofast-pagination {\n            gap: 6px !important;\n        }\n        \n        .gofast-page-link {\n            padding: 6px 10px !important;\n            font-size: 13px !important;\n            min-width: 36px !important;\n        }\n    }\n}\n<\/style>\n\n","active":true,"modified":"2025-12-12 14:16:24","revision":"1"}]}