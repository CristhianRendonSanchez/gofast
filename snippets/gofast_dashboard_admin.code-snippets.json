{
  "generator": "Code Snippets v3.9.2",
  "date_created": "2025-11-21 22:43",
  "snippets": [
    {
      "id": 24,
      "name": "gofast_dashboard_admin",
      "code": "/***************************************************\n * GOFAST â€“ DASHBOARD ADMINISTRATIVO\n * Shortcode: [gofast_dashboard_admin]\n * URL: /dashboard-admin\n ***************************************************/\nfunction gofast_dashboard_admin_shortcode() {\n    if (session_status() === PHP_SESSION_NONE) {\n        session_start();\n    }\n\n    global $wpdb;\n\n    /* ==========================================================\n       0. Validar usuario admin\n    ========================================================== */\n    $usuario = null;\n    if (!empty($_SESSION['gofast_user_id'])) {\n        $uid = (int) $_SESSION['gofast_user_id'];\n        $usuario = $wpdb->get_row(\n            $wpdb->prepare(\n                \"SELECT id, nombre, rol, activo \n                 FROM usuarios_gofast \n                 WHERE id = %d AND activo = 1\",\n                $uid\n            )\n        );\n    }\n\n    if (!$usuario || strtolower($usuario->rol) !== 'admin') {\n        return \"<div class='gofast-box'>\n                    âš ï¸ Solo los administradores pueden acceder al panel.\n                </div>\";\n    }\n\n    /* ==========================================================\n       1. EstadÃ­sticas rÃ¡pidas\n    ========================================================== */\n    $total_pedidos = (int) $wpdb->get_var(\"SELECT COUNT(*) FROM servicios_gofast\");\n    $pedidos_pendientes = (int) $wpdb->get_var(\"SELECT COUNT(*) FROM servicios_gofast WHERE tracking_estado = 'pendiente'\");\n    $pedidos_en_ruta = (int) $wpdb->get_var(\"SELECT COUNT(*) FROM servicios_gofast WHERE tracking_estado = 'en_ruta'\");\n    $pedidos_entregados = (int) $wpdb->get_var(\"SELECT COUNT(*) FROM servicios_gofast WHERE tracking_estado = 'entregado'\");\n    \n    $total_usuarios = (int) $wpdb->get_var(\"SELECT COUNT(*) FROM usuarios_gofast WHERE activo = 1\");\n    $total_clientes = (int) $wpdb->get_var(\"SELECT COUNT(*) FROM usuarios_gofast WHERE rol = 'cliente' AND activo = 1\");\n    $total_mensajeros = (int) $wpdb->get_var(\"SELECT COUNT(*) FROM usuarios_gofast WHERE rol = 'mensajero' AND activo = 1\");\n    \n    $total_ingresos = (float) $wpdb->get_var(\"SELECT SUM(total) FROM servicios_gofast WHERE tracking_estado = 'entregado'\");\n    $total_ingresos = $total_ingresos ?: 0;\n    \n    $pedidos_hoy = (int) $wpdb->get_var(\n        $wpdb->prepare(\n            \"SELECT COUNT(*) FROM servicios_gofast WHERE DATE(fecha) = %s\",\n            current_time('Y-m-d')\n        )\n    );\n\n    /* ==========================================================\n       2. HTML\n    ========================================================== */\n    ob_start();\n    ?>\n\n<div class=\"gofast-home\">\n    <h1 style=\"margin-bottom:8px;\">âš™ï¸ Panel Administrativo</h1>\n    <p class=\"gofast-home-text\">\n        Gestiona pedidos, usuarios, recargos y visualiza reportes del sistema.\n    </p>\n\n    <!-- Tarjetas de estadÃ­sticas -->\n    <div class=\"gofast-dashboard-stats\" style=\"display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;margin:24px 0;\">\n        \n        <!-- Pedidos -->\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">ğŸ“¦</div>\n            <div style=\"font-size:28px;font-weight:700;color:#F4C524;margin-bottom:4px;\"><?= number_format($total_pedidos); ?></div>\n            <div style=\"font-size:13px;color:#666;\">Total Pedidos</div>\n        </div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">â³</div>\n            <div style=\"font-size:28px;font-weight:700;color:#ff9800;margin-bottom:4px;\"><?= number_format($pedidos_pendientes); ?></div>\n            <div style=\"font-size:13px;color:#666;\">Pendientes</div>\n        </div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">ğŸšš</div>\n            <div style=\"font-size:28px;font-weight:700;color:#2196F3;margin-bottom:4px;\"><?= number_format($pedidos_en_ruta); ?></div>\n            <div style=\"font-size:13px;color:#666;\">En Ruta</div>\n        </div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">âœ…</div>\n            <div style=\"font-size:28px;font-weight:700;color:#4CAF50;margin-bottom:4px;\"><?= number_format($pedidos_entregados); ?></div>\n            <div style=\"font-size:13px;color:#666;\">Entregados</div>\n        </div>\n\n        <!-- Usuarios -->\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">ğŸ‘¥</div>\n            <div style=\"font-size:28px;font-weight:700;color:#9C27B0;margin-bottom:4px;\"><?= number_format($total_usuarios); ?></div>\n            <div style=\"font-size:13px;color:#666;\">Total Usuarios</div>\n        </div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">ğŸ›’</div>\n            <div style=\"font-size:28px;font-weight:700;color:#E91E63;margin-bottom:4px;\"><?= number_format($total_clientes); ?></div>\n            <div style=\"font-size:13px;color:#666;\">Clientes</div>\n        </div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">ğŸšš</div>\n            <div style=\"font-size:28px;font-weight:700;color:#00BCD4;margin-bottom:4px;\"><?= number_format($total_mensajeros); ?></div>\n            <div style=\"font-size:13px;color:#666;\">Mensajeros</div>\n        </div>\n\n        <!-- Ingresos -->\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">ğŸ’°</div>\n            <div style=\"font-size:28px;font-weight:700;color:#4CAF50;margin-bottom:4px;\">$<?= number_format($total_ingresos, 0, ',', '.'); ?></div>\n            <div style=\"font-size:13px;color:#666;\">Ingresos Totales</div>\n        </div>\n\n        <div class=\"gofast-box\" style=\"text-align:center;padding:20px;\">\n            <div style=\"font-size:32px;margin-bottom:8px;\">ğŸ“…</div>\n            <div style=\"font-size:28px;font-weight:700;color:#FF5722;margin-bottom:4px;\"><?= number_format($pedidos_hoy); ?></div>\n            <div style=\"font-size:13px;color:#666;\">Pedidos Hoy</div>\n        </div>\n\n    </div>\n\n    <!-- Enlaces de navegaciÃ³n -->\n    <div class=\"gofast-dashboard-links\" style=\"display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:16px;margin:32px 0;\">\n        \n        <a href=\"<?php echo esc_url( home_url('/mis-pedidos') ); ?>\" class=\"gofast-box\" style=\"display:block;text-decoration:none;padding:24px;transition:transform 0.2s, box-shadow 0.2s;\" onmouseover=\"this.style.transform='translateY(-4px)';this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';\" onmouseout=\"this.style.transform='';this.style.boxShadow='';\">\n            <div style=\"font-size:40px;margin-bottom:12px;\">ğŸ“¦</div>\n            <h3 style=\"margin:0 0 8px 0;color:#1a1a1a;\">GestiÃ³n de Pedidos</h3>\n            <p style=\"margin:0;color:#666;font-size:14px;\">Ver, filtrar y gestionar todos los pedidos del sistema</p>\n        </a>\n\n        <a href=\"<?php echo esc_url( home_url('/admin-usuarios') ); ?>\" class=\"gofast-box\" style=\"display:block;text-decoration:none;padding:24px;transition:transform 0.2s, box-shadow 0.2s;\" onmouseover=\"this.style.transform='translateY(-4px)';this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';\" onmouseout=\"this.style.transform='';this.style.boxShadow='';\">\n            <div style=\"font-size:40px;margin-bottom:12px;\">ğŸ‘¥</div>\n            <h3 style=\"margin:0 0 8px 0;color:#1a1a1a;\">GestiÃ³n de Usuarios</h3>\n            <p style=\"margin:0;color:#666;font-size:14px;\">Crear, editar y gestionar usuarios, clientes y mensajeros</p>\n        </a>\n\n        <a href=\"<?php echo esc_url( home_url('/recargos') ); ?>\" class=\"gofast-box\" style=\"display:block;text-decoration:none;padding:24px;transition:transform 0.2s, box-shadow 0.2s;\" onmouseover=\"this.style.transform='translateY(-4px)';this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';\" onmouseout=\"this.style.transform='';this.style.boxShadow='';\">\n            <div style=\"font-size:40px;margin-bottom:12px;\">âš™ï¸</div>\n            <h3 style=\"margin:0 0 8px 0;color:#1a1a1a;\">AdministraciÃ³n de Recargos</h3>\n            <p style=\"margin:0;color:#666;font-size:14px;\">Configurar recargos fijos y por valor para las cotizaciones</p>\n        </a>\n\n        <a href=\"<?php echo esc_url( home_url('/admin-reportes') ); ?>\" class=\"gofast-box\" style=\"display:block;text-decoration:none;padding:24px;transition:transform 0.2s, box-shadow 0.2s;\" onmouseover=\"this.style.transform='translateY(-4px)';this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';\" onmouseout=\"this.style.transform='';this.style.boxShadow='';\">\n            <div style=\"font-size:40px;margin-bottom:12px;\">ğŸ“Š</div>\n            <h3 style=\"margin:0 0 8px 0;color:#1a1a1a;\">Reportes y EstadÃ­sticas</h3>\n            <p style=\"margin:0;color:#666;font-size:14px;\">Ver reportes detallados, estadÃ­sticas y exportar datos</p>\n        </a>\n\n    </div>\n\n</div>\n\n<?php\n    return ob_get_clean();\n}\nadd_shortcode('gofast_dashboard_admin', 'gofast_dashboard_admin_shortcode');\n",
      "active": true,
      "modified": "2025-11-21 22:43",
      "revision": "1"
    }
  ]
}

