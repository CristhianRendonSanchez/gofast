{"generator":"Code Snippets v3.9.3","date_created":"2025-12-12 19:46","snippets":[{"id":39,"name":"gofast_admin_solicitudes_trabajo","code":"\/***************************************************\n * GOFAST \u2013 ADMINISTRACI\u00d3N DE SOLICITUDES DE TRABAJO (SOLO ADMIN)\n * Shortcode: [gofast_admin_solicitudes_trabajo]\n * URL: \/admin-solicitudes-trabajo\n * \n * Funcionalidades:\n * - Ver todas las solicitudes de trabajo\n * - Cambiar estado de las solicitudes\n * - Descargar hojas de vida\n * - Agregar notas internas\n * - Filtrar por estado\n ***************************************************\/\nfunction gofast_admin_solicitudes_trabajo_shortcode() {\n    global $wpdb;\n\n    if (session_status() === PHP_SESSION_NONE) {\n        session_start();\n    }\n\n    \/\/ Validar usuario admin\n    if (empty($_SESSION['gofast_user_id'])) {\n        return \"<div class='gofast-box'>Debes iniciar sesi\u00f3n para acceder a esta secci\u00f3n.<\/div>\";\n    }\n\n    $user_id = (int) $_SESSION['gofast_user_id'];\n    $rol = strtolower($_SESSION['gofast_user_rol'] ?? 'cliente');\n\n    if ($rol !== 'admin') {\n        return \"<div class='gofast-box'>\u26a0\ufe0f Solo los administradores pueden acceder a esta secci\u00f3n.<\/div>\";\n    }\n\n    $mensaje = '';\n    $mensaje_tipo = '';\n    \n    \/\/ Mostrar mensajes de \u00e9xito\/error desde redirecci\u00f3n\n    if (isset($_GET['actualizado']) && $_GET['actualizado'] == '1') {\n        $mensaje = 'Solicitud actualizada correctamente.';\n        $mensaje_tipo = 'success';\n    }\n    if (isset($_GET['eliminado']) && $_GET['eliminado'] == '1') {\n        $mensaje = 'Solicitud eliminada correctamente.';\n        $mensaje_tipo = 'success';\n    }\n\n    \/*********************************************\n     * VER DETALLES DE SOLICITUD (NUEVA P\u00c1GINA)\n     *********************************************\/\n    if (isset($_GET['ver']) && !empty($_GET['ver'])) {\n        $solicitud_id = (int) $_GET['ver'];\n        \n        $solicitud = $wpdb->get_row($wpdb->prepare(\n            \"SELECT * FROM solicitudes_trabajo WHERE id = %d\",\n            $solicitud_id\n        ));\n        \n        if (!$solicitud) {\n            return \"<div class='gofast-box'>\u26a0\ufe0f Solicitud no encontrada.<\/div>\";\n        }\n        \n        \/\/ Mensaje de \u00e9xito si viene de actualizaci\u00f3n\n        $mensaje_detalle = '';\n        $mensaje_tipo_detalle = '';\n        if (isset($_GET['actualizado']) && $_GET['actualizado'] == '1') {\n            $mensaje_detalle = 'Solicitud actualizada correctamente.';\n            $mensaje_tipo_detalle = 'success';\n        }\n        \n        ob_start();\n        ?>\n        <div class=\"gofast-home\">\n            <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:12px;\">\n                <div>\n                    <h1 style=\"margin-bottom:8px;\">\ud83d\udccb Detalles de la Solicitud #<?= esc_html($solicitud->id) ?><\/h1>\n                    <p class=\"gofast-home-text\" style=\"margin:0;\">\n                        Informaci\u00f3n completa de la solicitud de trabajo.\n                    <\/p>\n                <\/div>\n                <a href=\"<?php echo esc_url( remove_query_arg(['ver', 'actualizado']) ); ?>\" class=\"gofast-btn-request\" style=\"text-decoration:none;white-space:nowrap;\">\n                    \u2190 Volver a Solicitudes\n                <\/a>\n            <\/div>\n\n            <!-- Mensaje de resultado -->\n            <?php if ($mensaje_detalle): ?>\n                <div class=\"gofast-box\" style=\"background: <?= $mensaje_tipo_detalle === 'success' ? '#d4edda' : '#f8d7da' ?>; border-left: 4px solid <?= $mensaje_tipo_detalle === 'success' ? '#28a745' : '#dc3545' ?>; color: <?= $mensaje_tipo_detalle === 'success' ? '#155724' : '#721c24' ?>; margin-bottom: 20px;\">\n                    <?= esc_html($mensaje_detalle) ?>\n                <\/div>\n            <?php endif; ?>\n\n            <!-- Informaci\u00f3n del candidato -->\n            <div class=\"gofast-box\" style=\"margin-bottom: 20px;\">\n                <h3 style=\"margin-top: 0; margin-bottom: 20px;\">\ud83d\udc64 Informaci\u00f3n del Candidato<\/h3>\n                \n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;\">\n                    <div style=\"padding: 16px; background: #f8f9fa; border-radius: 8px;\">\n                        <div style=\"font-size: 13px; color: #666; margin-bottom: 4px;\">Nombre completo:<\/div>\n                        <div style=\"font-size: 18px; font-weight: 700; color: #000;\"><?= esc_html($solicitud->nombre) ?><\/div>\n                    <\/div>\n                    \n                    <div style=\"padding: 16px; background: #f8f9fa; border-radius: 8px;\">\n                        <div style=\"font-size: 13px; color: #666; margin-bottom: 4px;\">WhatsApp:<\/div>\n                        <div style=\"font-size: 18px; font-weight: 700; color: #000;\">\n                            <a href=\"https:\/\/wa.me\/<?= esc_attr(preg_replace('\/[^0-9]\/', '', $solicitud->whatsapp)) ?>\" \n                               target=\"_blank\" \n                               style=\"color: #25D366; text-decoration: none;\">\n                                \ud83d\udcf1 <?= esc_html($solicitud->whatsapp) ?>\n                            <\/a>\n                        <\/div>\n                    <\/div>\n                    \n                    <?php if ($solicitud->email): ?>\n                    <div style=\"padding: 16px; background: #f8f9fa; border-radius: 8px;\">\n                        <div style=\"font-size: 13px; color: #666; margin-bottom: 4px;\">Email:<\/div>\n                        <div style=\"font-size: 18px; font-weight: 700; color: #000;\">\n                            <a href=\"mailto:<?= esc_attr($solicitud->email) ?>\" style=\"color: #007bff; text-decoration: none;\">\n                                \u2709\ufe0f <?= esc_html($solicitud->email) ?>\n                            <\/a>\n                        <\/div>\n                    <\/div>\n                    <?php endif; ?>\n                    \n                    <div style=\"padding: 16px; background: #f8f9fa; border-radius: 8px;\">\n                        <div style=\"font-size: 13px; color: #666; margin-bottom: 4px;\">Estado:<\/div>\n                        <div>\n                            <span class=\"gofast-badge-estado \n                                <?php\n                                switch($solicitud->estado) {\n                                    case 'pendiente': echo 'gofast-badge-estado-pendiente'; break;\n                                    case 'revisado': echo 'gofast-badge-estado-asignado'; break;\n                                    case 'contactado': echo 'gofast-badge-estado-en_ruta'; break;\n                                    case 'rechazado': echo 'gofast-badge-estado-cancelado'; break;\n                                }\n                                ?>\">\n                                <?php\n                                switch($solicitud->estado) {\n                                    case 'pendiente': echo '\u23f3 Pendiente'; break;\n                                    case 'revisado': echo '\ud83d\udc40 Revisado'; break;\n                                    case 'contactado': echo '\ud83d\udcde Contactado'; break;\n                                    case 'rechazado': echo '\u274c Rechazado'; break;\n                                }\n                                ?>\n                            <\/span>\n                        <\/div>\n                    <\/div>\n                <\/div>\n            <\/div>\n\n            <!-- Respuestas a las preguntas -->\n            <div class=\"gofast-box\" style=\"margin-bottom: 20px;\">\n                <h3 style=\"margin-top: 0; margin-bottom: 20px;\">\u2753 Respuestas del Candidato<\/h3>\n                \n                <div style=\"display: grid; gap: 16px;\">\n                    <div style=\"padding: 16px; background: #f8f9fa; border-left: 4px solid var(--gofast-yellow); border-radius: 6px;\">\n                        <div style=\"font-size: 14px; font-weight: 700; color: #000; margin-bottom: 8px;\">\n                            1. \u00bfTiene experiencia en reparto a domicilio y conocimiento en direcciones? \ud83e\udd89\n                        <\/div>\n                        <div style=\"font-size: 15px; color: #333; line-height: 1.6; white-space: pre-wrap;\">\n                            <?= esc_html($solicitud->pregunta1) ?>\n                        <\/div>\n                    <\/div>\n                    \n                    <div style=\"padding: 16px; background: #f8f9fa; border-left: 4px solid var(--gofast-yellow); border-radius: 6px;\">\n                        <div style=\"font-size: 14px; font-weight: 700; color: #000; margin-bottom: 8px;\">\n                            2. \u00bfCu\u00e1l es su disponibilidad de tiempo? \ud83d\udd50\n                        <\/div>\n                        <div style=\"font-size: 15px; color: #333; line-height: 1.6; white-space: pre-wrap;\">\n                            <?= esc_html($solicitud->pregunta2) ?>\n                        <\/div>\n                    <\/div>\n                    \n                    <div style=\"padding: 16px; background: #f8f9fa; border-left: 4px solid var(--gofast-yellow); border-radius: 6px;\">\n                        <div style=\"font-size: 14px; font-weight: 700; color: #000; margin-bottom: 8px;\">\n                            3. \u00bfTiene veh\u00edculo propio con documentaci\u00f3n al d\u00eda? \u2714\n                        <\/div>\n                        <div style=\"font-size: 15px; color: #333; line-height: 1.6; white-space: pre-wrap;\">\n                            <?= esc_html($solicitud->pregunta3) ?>\n                        <\/div>\n                    <\/div>\n                    \n                    <div style=\"padding: 16px; background: #f8f9fa; border-left: 4px solid var(--gofast-yellow); border-radius: 6px;\">\n                        <div style=\"font-size: 14px; font-weight: 700; color: #000; margin-bottom: 8px;\">\n                            4. \u00bfTipo de motocicleta? \ud83d\udef5\n                        <\/div>\n                        <div style=\"font-size: 15px; color: #333; line-height: 1.6; white-space: pre-wrap;\">\n                            <?= esc_html($solicitud->pregunta4) ?>\n                        <\/div>\n                    <\/div>\n                    \n                    <div style=\"padding: 16px; background: #f8f9fa; border-left: 4px solid var(--gofast-yellow); border-radius: 6px;\">\n                        <div style=\"font-size: 14px; font-weight: 700; color: #000; margin-bottom: 8px;\">\n                            5. \u00bfCiudad de residencia? \ud83c\udfe0\n                        <\/div>\n                        <div style=\"font-size: 15px; color: #333; line-height: 1.6; white-space: pre-wrap;\">\n                            <?= esc_html($solicitud->pregunta5) ?>\n                        <\/div>\n                    <\/div>\n                <\/div>\n            <\/div>\n\n            <!-- Hoja de vida -->\n            <?php if ($solicitud->archivo_cv): ?>\n            <div class=\"gofast-box\" style=\"margin-bottom: 20px;\">\n                <h3 style=\"margin-top: 0; margin-bottom: 16px;\">\ud83d\udcc4 Hoja de Vida<\/h3>\n                <div style=\"padding: 16px; background: #f8f9fa; border-radius: 8px;\">\n                    <div style=\"display: flex; align-items: center; gap: 12px; flex-wrap: wrap;\">\n                        <div style=\"flex: 1;\">\n                            <div style=\"font-size: 13px; color: #666; margin-bottom: 4px;\">Archivo:<\/div>\n                            <div style=\"font-size: 15px; font-weight: 600; color: #000;\">\n                                <?= esc_html($solicitud->nombre_archivo) ?>\n                            <\/div>\n                        <\/div>\n                        <a href=\"<?= esc_url($solicitud->archivo_cv) ?>\" \n                           target=\"_blank\" \n                           download\n                           class=\"gofast-btn-mini\" \n                           style=\"background: #28a745; color: #fff; text-decoration: none; padding: 12px 20px;\">\n                            \ud83d\udce5 Descargar CV\n                        <\/a>\n                    <\/div>\n                <\/div>\n            <\/div>\n            <?php endif; ?>\n\n            <!-- Informaci\u00f3n adicional -->\n            <div class=\"gofast-box\" style=\"margin-bottom: 20px;\">\n                <h3 style=\"margin-top: 0; margin-bottom: 16px;\">\ud83d\udcc5 Informaci\u00f3n Adicional<\/h3>\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;\">\n                    <div style=\"padding: 12px; background: #f8f9fa; border-radius: 6px;\">\n                        <div style=\"font-size: 12px; color: #666; margin-bottom: 4px;\">Fecha de solicitud:<\/div>\n                        <div style=\"font-size: 14px; font-weight: 600; color: #000;\">\n                            <?= gofast_date_format($solicitud->created_at, 'd\/m\/Y H:i') ?>\n                        <\/div>\n                    <\/div>\n                    <?php if ($solicitud->updated_at): ?>\n                    <div style=\"padding: 12px; background: #f8f9fa; border-radius: 6px;\">\n                        <div style=\"font-size: 12px; color: #666; margin-bottom: 4px;\">\u00daltima actualizaci\u00f3n:<\/div>\n                        <div style=\"font-size: 14px; font-weight: 600; color: #000;\">\n                            <?= gofast_date_format($solicitud->updated_at, 'd\/m\/Y H:i') ?>\n                        <\/div>\n                    <\/div>\n                    <?php endif; ?>\n                <\/div>\n            <\/div>\n\n            <!-- Formulario de gesti\u00f3n -->\n            <div class=\"gofast-box\" style=\"margin-bottom: 20px;\">\n                <h3 style=\"margin-top: 0; margin-bottom: 16px;\">\u2699\ufe0f Gestionar Solicitud<\/h3>\n                \n                <form method=\"post\">\n                    <?php wp_nonce_field('gofast_actualizar_solicitud', 'gofast_actualizar_solicitud_nonce'); ?>\n                    <input type=\"hidden\" name=\"gofast_actualizar_solicitud\" value=\"1\">\n                    <input type=\"hidden\" name=\"solicitud_id\" value=\"<?= esc_attr($solicitud->id) ?>\">\n                    \n                    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-bottom: 16px;\">\n                        <div>\n                            <label style=\"display: block; font-weight: 600; margin-bottom: 8px; font-size: 14px; color: #000;\">Estado:<\/label>\n                            <select name=\"estado\" required style=\"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 15px;\">\n                                <option value=\"pendiente\" <?= $solicitud->estado === 'pendiente' ? 'selected' : '' ?>>\u23f3 Pendiente<\/option>\n                                <option value=\"revisado\" <?= $solicitud->estado === 'revisado' ? 'selected' : '' ?>>\ud83d\udc40 Revisado<\/option>\n                                <option value=\"contactado\" <?= $solicitud->estado === 'contactado' ? 'selected' : '' ?>>\ud83d\udcde Contactado<\/option>\n                                <option value=\"rechazado\" <?= $solicitud->estado === 'rechazado' ? 'selected' : '' ?>>\u274c Rechazado<\/option>\n                            <\/select>\n                        <\/div>\n                    <\/div>\n                    \n                    <div style=\"margin-bottom: 16px;\">\n                        <label style=\"display: block; font-weight: 600; margin-bottom: 8px; font-size: 14px; color: #000;\">Notas internas:<\/label>\n                        <textarea name=\"notas\" \n                                  rows=\"4\"\n                                  placeholder=\"Notas sobre esta solicitud...\"\n                                  style=\"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical; font-family: inherit; box-sizing: border-box;\"><?= esc_textarea($solicitud->notas) ?><\/textarea>\n                    <\/div>\n                    \n                    <div style=\"display: flex; gap: 12px; flex-wrap: wrap;\">\n                        <button type=\"submit\" class=\"gofast-btn-mini\" style=\"background: var(--gofast-yellow); color: #000;\">\n                            \ud83d\udcbe Guardar Cambios\n                        <\/button>\n                        <a href=\"https:\/\/wa.me\/<?= esc_attr(preg_replace('\/[^0-9]\/', '', $solicitud->whatsapp)) ?>?text=<?= urlencode('Hola ' . $solicitud->nombre . ', hemos revisado tu solicitud de trabajo en GO FAST mensajer\u00eda express. \u00bfPodr\u00edas contactarnos para continuar con el proceso?') ?>\" \n                           target=\"_blank\" \n                           class=\"gofast-btn-request\" \n                           style=\"background: #25D366; color: #fff; text-decoration: none; padding: 14px 24px; font-size: 16px; display: inline-block;\">\n                            \ud83d\udcf1 Contactar por WhatsApp\n                        <\/a>\n                        <form method=\"post\" style=\"display:inline-block;\" onsubmit=\"return confirm('\u00bfEst\u00e1s seguro de eliminar esta solicitud?');\">\n                            <?php wp_nonce_field('gofast_eliminar_solicitud', 'gofast_eliminar_solicitud_nonce'); ?>\n                            <input type=\"hidden\" name=\"gofast_eliminar_solicitud\" value=\"1\">\n                            <input type=\"hidden\" name=\"solicitud_id\" value=\"<?= esc_attr($solicitud->id) ?>\">\n                            <button type=\"submit\" class=\"gofast-btn-mini\" style=\"background:#dc3545;color:#fff;\">\n                                \ud83d\uddd1\ufe0f Eliminar Solicitud\n                            <\/button>\n                        <\/form>\n                    <\/div>\n                <\/form>\n            <\/div>\n        <\/div>\n        <?php\n        return ob_get_clean();\n    }\n\n    \/*********************************************\n     * PROCESAMIENTO DE FORMULARIOS\n     *********************************************\/\n\n    \/\/ 1. ACTUALIZAR ESTADO Y NOTAS\n    if (isset($_POST['gofast_actualizar_solicitud']) && wp_verify_nonce($_POST['gofast_actualizar_solicitud_nonce'], 'gofast_actualizar_solicitud')) {\n        $solicitud_id = (int) $_POST['solicitud_id'];\n        $estado = sanitize_text_field($_POST['estado'] ?? 'pendiente');\n        $notas = sanitize_textarea_field($_POST['notas'] ?? '');\n\n        $actualizado = $wpdb->update(\n            'solicitudes_trabajo',\n            [\n                'estado' => $estado,\n                'notas' => $notas,\n                'updated_at' => gofast_current_time('mysql')\n            ],\n            ['id' => $solicitud_id],\n            ['%s', '%s', '%s'],\n            ['%d']\n        );\n\n        if ($actualizado !== false) {\n            \/\/ Redirigir a la p\u00e1gina de detalles si estamos viendo una solicitud\n            if (isset($_GET['ver'])) {\n                wp_safe_redirect(add_query_arg(['ver' => $solicitud_id, 'actualizado' => '1']));\n            } else {\n                wp_safe_redirect(add_query_arg(['actualizado' => '1']));\n            }\n            exit;\n        } else {\n            $mensaje = 'Error al actualizar la solicitud.';\n            $mensaje_tipo = 'error';\n        }\n    }\n\n    \/\/ 2. ELIMINAR SOLICITUD\n    if (isset($_POST['gofast_eliminar_solicitud']) && wp_verify_nonce($_POST['gofast_eliminar_solicitud_nonce'], 'gofast_eliminar_solicitud')) {\n        $solicitud_id = (int) $_POST['solicitud_id'];\n\n        \/\/ Obtener informaci\u00f3n del archivo antes de eliminar\n        $solicitud = $wpdb->get_row($wpdb->prepare(\n            \"SELECT archivo_cv FROM solicitudes_trabajo WHERE id = %d\",\n            $solicitud_id\n        ));\n\n        \/\/ Eliminar archivo f\u00edsico si existe\n        if ($solicitud && $solicitud->archivo_cv) {\n            $upload_dir = wp_upload_dir();\n            $ruta_archivo = str_replace($upload_dir['baseurl'], $upload_dir['basedir'], $solicitud->archivo_cv);\n            if (file_exists($ruta_archivo)) {\n                @unlink($ruta_archivo);\n            }\n        }\n\n        $eliminado = $wpdb->delete('solicitudes_trabajo', ['id' => $solicitud_id], ['%d']);\n\n        if ($eliminado) {\n            \/\/ Si estamos en la p\u00e1gina de detalles, redirigir a la lista\n            if (isset($_GET['ver'])) {\n                wp_safe_redirect(remove_query_arg('ver'));\n            } else {\n                wp_safe_redirect(add_query_arg(['eliminado' => '1']));\n            }\n            exit;\n        } else {\n            $mensaje = 'Error al eliminar la solicitud.';\n            $mensaje_tipo = 'error';\n        }\n    }\n\n    \/*********************************************\n     * OBTENER DATOS\n     *********************************************\/\n\n    \/\/ Filtro por estado\n    $filtro_estado = isset($_GET['estado']) ? sanitize_text_field($_GET['estado']) : '';\n\n    $where = '';\n    if (!empty($filtro_estado) && in_array($filtro_estado, ['pendiente', 'revisado', 'contactado', 'rechazado'])) {\n        $where = $wpdb->prepare(\" WHERE estado = %s\", $filtro_estado);\n    }\n\n    \/\/ Obtener todas las solicitudes\n    $solicitudes = $wpdb->get_results(\n        \"SELECT * FROM solicitudes_trabajo\" . $where . \" ORDER BY created_at DESC\"\n    );\n\n    \/\/ Estad\u00edsticas\n    $total_solicitudes = count($solicitudes);\n    $pendientes = $wpdb->get_var(\"SELECT COUNT(*) FROM solicitudes_trabajo WHERE estado = 'pendiente'\");\n    $revisados = $wpdb->get_var(\"SELECT COUNT(*) FROM solicitudes_trabajo WHERE estado = 'revisado'\");\n    $contactados = $wpdb->get_var(\"SELECT COUNT(*) FROM solicitudes_trabajo WHERE estado = 'contactado'\");\n    $rechazados = $wpdb->get_var(\"SELECT COUNT(*) FROM solicitudes_trabajo WHERE estado = 'rechazado'\");\n\n    ob_start();\n    ?>\n\n<div class=\"gofast-home\">\n    <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:12px;\">\n        <div>\n            <h1 style=\"margin-bottom:8px;\">\ud83d\udccb Solicitudes de Trabajo<\/h1>\n            <p class=\"gofast-home-text\" style=\"margin:0;\">\n                Gestiona las solicitudes de trabajo de mensajeros.\n            <\/p>\n        <\/div>\n        <a href=\"<?php echo esc_url( home_url('\/dashboard-admin') ); ?>\" class=\"gofast-btn-request\" style=\"text-decoration:none;white-space:nowrap;\">\n            \u2190 Volver al Dashboard\n        <\/a>\n    <\/div>\n\n    <!-- Mensaje de resultado -->\n    <?php if ($mensaje): ?>\n        <div class=\"gofast-box\" style=\"background: <?= $mensaje_tipo === 'success' ? '#d4edda' : '#f8d7da' ?>; border-left: 4px solid <?= $mensaje_tipo === 'success' ? '#28a745' : '#dc3545' ?>; color: <?= $mensaje_tipo === 'success' ? '#155724' : '#721c24' ?>; margin-bottom: 20px;\">\n            <?= esc_html($mensaje) ?>\n        <\/div>\n    <?php endif; ?>\n\n    <!-- Estad\u00edsticas -->\n    <div class=\"gofast-box\" style=\"margin-bottom: 20px;\">\n        <h3>\ud83d\udcca Estad\u00edsticas<\/h3>\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-top: 15px;\">\n            <div style=\"text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px;\">\n                <div style=\"font-size: 24px; font-weight: 700; color: #333;\"><?= $total_solicitudes ?><\/div>\n                <div style=\"font-size: 13px; color: #666;\">Total Solicitudes<\/div>\n            <\/div>\n            <div style=\"text-align: center; padding: 15px; background: #fff3cd; border-radius: 8px;\">\n                <div style=\"font-size: 24px; font-weight: 700; color: #856404;\"><?= $pendientes ?><\/div>\n                <div style=\"font-size: 13px; color: #666;\">Pendientes<\/div>\n            <\/div>\n            <div style=\"text-align: center; padding: 15px; background: #d1ecf1; border-radius: 8px;\">\n                <div style=\"font-size: 24px; font-weight: 700; color: #0c5460;\"><?= $revisados ?><\/div>\n                <div style=\"font-size: 13px; color: #666;\">Revisados<\/div>\n            <\/div>\n            <div style=\"text-align: center; padding: 15px; background: #cce5ff; border-radius: 8px;\">\n                <div style=\"font-size: 24px; font-weight: 700; color: #004085;\"><?= $contactados ?><\/div>\n                <div style=\"font-size: 13px; color: #666;\">Contactados<\/div>\n            <\/div>\n            <div style=\"text-align: center; padding: 15px; background: #f8d7da; border-radius: 8px;\">\n                <div style=\"font-size: 24px; font-weight: 700; color: #721c24;\"><?= $rechazados ?><\/div>\n                <div style=\"font-size: 13px; color: #666;\">Rechazados<\/div>\n            <\/div>\n        <\/div>\n    <\/div>\n\n    <!-- Filtros -->\n    <div class=\"gofast-box\" style=\"margin-bottom: 20px;\">\n        <form method=\"get\" style=\"display: flex; gap: 12px; align-items: flex-end; flex-wrap: wrap;\">\n            <div style=\"flex: 1; min-width: 200px;\">\n                <label style=\"display: block; font-weight: 600; margin-bottom: 4px; font-size: 13px;\">Filtrar por estado:<\/label>\n                <select name=\"estado\" style=\"width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;\">\n                    <option value=\"\">Todos los estados<\/option>\n                    <option value=\"pendiente\" <?= $filtro_estado === 'pendiente' ? 'selected' : '' ?>>Pendiente<\/option>\n                    <option value=\"revisado\" <?= $filtro_estado === 'revisado' ? 'selected' : '' ?>>Revisado<\/option>\n                    <option value=\"contactado\" <?= $filtro_estado === 'contactado' ? 'selected' : '' ?>>Contactado<\/option>\n                    <option value=\"rechazado\" <?= $filtro_estado === 'rechazado' ? 'selected' : '' ?>>Rechazado<\/option>\n                <\/select>\n            <\/div>\n            <button type=\"submit\" class=\"gofast-btn-mini\" style=\"background: var(--gofast-yellow); color: #000;\">\n                \ud83d\udd0d Filtrar\n            <\/button>\n            <?php if ($filtro_estado): ?>\n                <a href=\"<?php echo esc_url( remove_query_arg('estado') ); ?>\" class=\"gofast-btn-mini gofast-btn-outline\">\n                    Limpiar\n                <\/a>\n            <?php endif; ?>\n        <\/form>\n    <\/div>\n\n    <!-- Listado de solicitudes -->\n    <div class=\"gofast-box\">\n        <h3>\ud83d\udccb Todas las Solicitudes<\/h3>\n        \n        <?php if (empty($solicitudes)): ?>\n            <p style=\"text-align: center; color: #666; padding: 20px;\">\n                No hay solicitudes registradas.\n            <\/p>\n        <?php else: ?>\n            <div class=\"gofast-table-wrap\" style=\"overflow-x: auto;\">\n                <table class=\"gofast-table\" style=\"min-width: 1000px;\">\n                    <thead>\n                        <tr>\n                            <th>ID<\/th>\n                            <th>Nombre<\/th>\n                            <th>WhatsApp<\/th>\n                            <th>Email<\/th>\n                            <th>Estado<\/th>\n                            <th>CV<\/th>\n                            <th>Fecha<\/th>\n                            <th>Acciones<\/th>\n                        <\/tr>\n                    <\/thead>\n                    <tbody>\n                        <?php foreach ($solicitudes as $s): ?>\n                            <tr>\n                                <td>#<?= esc_html($s->id) ?><\/td>\n                                <td><strong><?= esc_html($s->nombre) ?><\/strong><\/td>\n                                <td>\n                                    <a href=\"https:\/\/wa.me\/<?= esc_attr(preg_replace('\/[^0-9]\/', '', $s->whatsapp)) ?>\" \n                                       target=\"_blank\" \n                                       style=\"color: #25D366; text-decoration: none;\">\n                                        \ud83d\udcf1 <?= esc_html($s->whatsapp) ?>\n                                    <\/a>\n                                <\/td>\n                                <td><?= $s->email ? esc_html($s->email) : '\u2014' ?><\/td>\n                                <td>\n                                    <span class=\"gofast-badge-estado \n                                        <?php\n                                        switch($s->estado) {\n                                            case 'pendiente': echo 'gofast-badge-estado-pendiente'; break;\n                                            case 'revisado': echo 'gofast-badge-estado-asignado'; break;\n                                            case 'contactado': echo 'gofast-badge-estado-en_ruta'; break;\n                                            case 'rechazado': echo 'gofast-badge-estado-cancelado'; break;\n                                        }\n                                        ?>\">\n                                        <?php\n                                        switch($s->estado) {\n                                            case 'pendiente': echo '\u23f3 Pendiente'; break;\n                                            case 'revisado': echo '\ud83d\udc40 Revisado'; break;\n                                            case 'contactado': echo '\ud83d\udcde Contactado'; break;\n                                            case 'rechazado': echo '\u274c Rechazado'; break;\n                                        }\n                                        ?>\n                                    <\/span>\n                                <\/td>\n                                <td>\n                                    <?php if ($s->archivo_cv): ?>\n                                        <a href=\"<?= esc_url($s->archivo_cv) ?>\" \n                                           target=\"_blank\" \n                                           download\n                                           class=\"gofast-btn-mini\" \n                                           style=\"background: #28a745; color: #fff; text-decoration: none;\">\n                                            \ud83d\udce5 Descargar CV\n                                        <\/a>\n                                    <?php else: ?>\n                                        <span style=\"color: #999;\">Sin CV<\/span>\n                                    <?php endif; ?>\n                                <\/td>\n                                <td><?= gofast_date_format($s->created_at, 'd\/m\/Y H:i') ?><\/td>\n                                    <td style=\"white-space:nowrap;\">\n                                        <a href=\"<?= esc_url( add_query_arg('ver', $s->id) ) ?>\" \n                                           class=\"gofast-btn-mini\" \n                                           style=\"background: var(--gofast-yellow); color: #000; text-decoration: none; margin-right: 4px; display: inline-block; padding: 8px 14px;\">\n                                            \ud83d\udc41\ufe0f Ver Detalles\n                                        <\/a>\n                                        <form method=\"post\" style=\"display:inline-block;\" onsubmit=\"return confirm('\u00bfEst\u00e1s seguro de eliminar esta solicitud?');\">\n                                            <?php wp_nonce_field('gofast_eliminar_solicitud', 'gofast_eliminar_solicitud_nonce'); ?>\n                                            <input type=\"hidden\" name=\"gofast_eliminar_solicitud\" value=\"1\">\n                                            <input type=\"hidden\" name=\"solicitud_id\" value=\"<?= esc_attr($s->id) ?>\">\n                                            <button type=\"submit\" class=\"gofast-btn-mini\" style=\"background:#dc3545;color:#fff;\">\n                                                \ud83d\uddd1\ufe0f Eliminar\n                                            <\/button>\n                                        <\/form>\n                                    <\/td>\n                            <\/tr>\n                        <?php endforeach; ?>\n                    <\/tbody>\n                <\/table>\n            <\/div>\n        <?php endif; ?>\n    <\/div>\n<\/div>\n\n\n    <?php\n    return ob_get_clean();\n}\nadd_shortcode('gofast_admin_solicitudes_trabajo', 'gofast_admin_solicitudes_trabajo_shortcode');\n\n","active":true,"modified":"2025-12-06 22:02:33","revision":"1"}]}